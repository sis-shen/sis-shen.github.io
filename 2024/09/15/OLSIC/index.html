<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>ç½‘ç»œè‚¡ç¥¨ä¿¡æ¯çˆ¬è™«ä¸å¯è§†åŒ– | supdriverçš„åšå®¢</title><meta name="author" content="å‰¯é©¾supdriver"><meta name="copyright" content="å‰¯é©¾supdriver"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="ffffff"><meta name="description" content="èƒŒæ™¯åˆ†æèƒŒæ™¯æ¦‚è¿°åœ¨å½“ä»Šå¿«é€Ÿå‘å±•çš„é‡‘èå¸‚åœºä¸­ï¼Œè‚¡ç¥¨å¸‚åœºçš„åŠ¨æ€å˜åŒ–å¯¹æŠ•èµ„è€…å’Œé‡‘èåˆ†æå¸ˆè‡³å…³é‡è¦ã€‚éšç€ä¿¡æ¯æŠ€æœ¯çš„è¿›æ­¥ï¼Œç‰¹åˆ«æ˜¯äº’è”ç½‘å’Œå¤§æ•°æ®æŠ€æœ¯çš„å‘å±•ï¼ŒæŠ•èµ„è€…å¯ä»¥å®æ—¶è·å¾—å¤§é‡çš„è‚¡ç¥¨å¸‚åœºä¿¡æ¯ã€‚ç„¶è€Œï¼Œè¿™äº›ä¿¡æ¯é€šå¸¸ä»¥åŸå§‹æ•°æ®å½¢å¼å­˜åœ¨ï¼Œéœ€è¦è¿›ä¸€æ­¥å¤„ç†å’Œåˆ†ææ‰èƒ½æå–æœ‰ä»·å€¼çš„æ´è§ã€‚åœ¨è¿™ç§èƒŒæ™¯ä¸‹ï¼Œç½‘ç»œè‚¡ç¥¨ä¿¡æ¯çˆ¬è™«ä¸å¯è§†åŒ–æŠ€æœ¯åº”è¿è€Œç”Ÿï¼Œæˆä¸ºè‚¡ç¥¨å¸‚åœºåˆ†æçš„é‡è¦å·¥å…·ã€‚ ç½‘ç»œè‚¡ç¥¨ä¿¡æ¯çˆ¬è™«ç½‘ç»œè‚¡ç¥¨ä¿¡æ¯çˆ¬è™«ï¼ˆWeb Scrapin">
<meta property="og:type" content="article">
<meta property="og:title" content="ç½‘ç»œè‚¡ç¥¨ä¿¡æ¯çˆ¬è™«ä¸å¯è§†åŒ–">
<meta property="og:url" content="http://supdriver.top/2024/09/15/OLSIC/index.html">
<meta property="og:site_name" content="supdriverçš„åšå®¢">
<meta property="og:description" content="èƒŒæ™¯åˆ†æèƒŒæ™¯æ¦‚è¿°åœ¨å½“ä»Šå¿«é€Ÿå‘å±•çš„é‡‘èå¸‚åœºä¸­ï¼Œè‚¡ç¥¨å¸‚åœºçš„åŠ¨æ€å˜åŒ–å¯¹æŠ•èµ„è€…å’Œé‡‘èåˆ†æå¸ˆè‡³å…³é‡è¦ã€‚éšç€ä¿¡æ¯æŠ€æœ¯çš„è¿›æ­¥ï¼Œç‰¹åˆ«æ˜¯äº’è”ç½‘å’Œå¤§æ•°æ®æŠ€æœ¯çš„å‘å±•ï¼ŒæŠ•èµ„è€…å¯ä»¥å®æ—¶è·å¾—å¤§é‡çš„è‚¡ç¥¨å¸‚åœºä¿¡æ¯ã€‚ç„¶è€Œï¼Œè¿™äº›ä¿¡æ¯é€šå¸¸ä»¥åŸå§‹æ•°æ®å½¢å¼å­˜åœ¨ï¼Œéœ€è¦è¿›ä¸€æ­¥å¤„ç†å’Œåˆ†ææ‰èƒ½æå–æœ‰ä»·å€¼çš„æ´è§ã€‚åœ¨è¿™ç§èƒŒæ™¯ä¸‹ï¼Œç½‘ç»œè‚¡ç¥¨ä¿¡æ¯çˆ¬è™«ä¸å¯è§†åŒ–æŠ€æœ¯åº”è¿è€Œç”Ÿï¼Œæˆä¸ºè‚¡ç¥¨å¸‚åœºåˆ†æçš„é‡è¦å·¥å…·ã€‚ ç½‘ç»œè‚¡ç¥¨ä¿¡æ¯çˆ¬è™«ç½‘ç»œè‚¡ç¥¨ä¿¡æ¯çˆ¬è™«ï¼ˆWeb Scrapin">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://picbed0521.oss-cn-shanghai.aliyuncs.com/blogpic/OLSIC_cover.png">
<meta property="article:published_time" content="2024-09-15T08:32:03.310Z">
<meta property="article:modified_time" content="2024-11-12T00:04:14.311Z">
<meta property="article:author" content="å‰¯é©¾supdriver">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://picbed0521.oss-cn-shanghai.aliyuncs.com/blogpic/OLSIC_cover.png"><link rel="shortcut icon" href="https://picbed0521.oss-cn-shanghai.aliyuncs.com/blogpic/sup_avator.webp"><link rel="canonical" href="http://supdriver.top/2024/09/15/OLSIC/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"æ‰¾ä¸åˆ°æ‚¨æŸ¥è¯¢çš„å†…å®¹ï¼š${query}","hits_stats":"å…±æ‰¾åˆ° ${hits} ç¯‡æ–‡ç« "}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":230},
  copy: {
    success: 'å¤åˆ¶æˆåŠŸ',
    error: 'å¤åˆ¶é”™è¯¯',
    noSupport: 'æµè§ˆå™¨ä¸æ”¯æŒ'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: 'å¤©',
  dateSuffix: {
    just: 'åˆšåˆš',
    min: 'åˆ†é’Ÿå‰',
    hour: 'å°æ—¶å‰',
    day: 'å¤©å‰',
    month: 'ä¸ªæœˆå‰'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'ç½‘ç»œè‚¡ç¥¨ä¿¡æ¯çˆ¬è™«ä¸å¯è§†åŒ–',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-11-12 08:04:14'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
    win.getCSS = (url,id = false) => new Promise((resolve, reject) => {
      const link = document.createElement('link')
      link.rel = 'stylesheet'
      link.href = url
      if (id) link.id = id
      link.onerror = reject
      link.onload = link.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        link.onload = link.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(link)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          const now = new Date()
          const hour = now.getHours()
          const isNight = hour <= 6 || hour >= 18
          if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
          else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="/css/custom.css" media="defer" onload="this.media='all'"><link rel="stylesheet" href="/css/universe.css"><!-- hexo injector head_end start --><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-categories-card@1.0.0/lib/categorybar.css"><!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://picbed0521.oss-cn-shanghai.aliyuncs.com/blogpic/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">78</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">21</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">0</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> é¦–é¡µ</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> å½’æ¡£</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> åˆ†ç±»</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> å‹é“¾</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> å…³äº</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://picbed0521.oss-cn-shanghai.aliyuncs.com/blogpic/OLSIC_cover.png')"><nav id="nav"><span id="blog-info"><a href="/" title="supdriverçš„åšå®¢"><span class="site-name">supdriverçš„åšå®¢</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> æœç´¢</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> é¦–é¡µ</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> å½’æ¡£</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> åˆ†ç±»</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> å‹é“¾</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> å…³äº</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">ç½‘ç»œè‚¡ç¥¨ä¿¡æ¯çˆ¬è™«ä¸å¯è§†åŒ–</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">å‘è¡¨äº</span><time class="post-meta-date-created" datetime="2024-09-15T08:32:03.310Z" title="å‘è¡¨äº 2024-09-15 16:32:03">2024-09-15</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">æ›´æ–°äº</span><time class="post-meta-date-updated" datetime="2024-11-12T00:04:14.311Z" title="æ›´æ–°äº 2024-11-12 08:04:14">2024-11-12</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">å­—æ•°æ€»è®¡:</span><span class="word-count">6.1k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">é˜…è¯»æ—¶é•¿:</span><span>25åˆ†é’Ÿ</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="ç½‘ç»œè‚¡ç¥¨ä¿¡æ¯çˆ¬è™«ä¸å¯è§†åŒ–"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">é˜…è¯»é‡:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="èƒŒæ™¯åˆ†æ"><a href="#èƒŒæ™¯åˆ†æ" class="headerlink" title="èƒŒæ™¯åˆ†æ"></a>èƒŒæ™¯åˆ†æ</h1><h2 id="èƒŒæ™¯æ¦‚è¿°"><a href="#èƒŒæ™¯æ¦‚è¿°" class="headerlink" title="èƒŒæ™¯æ¦‚è¿°"></a>èƒŒæ™¯æ¦‚è¿°</h2><p>åœ¨å½“ä»Šå¿«é€Ÿå‘å±•çš„é‡‘èå¸‚åœºä¸­ï¼Œè‚¡ç¥¨å¸‚åœºçš„åŠ¨æ€å˜åŒ–å¯¹æŠ•èµ„è€…å’Œé‡‘èåˆ†æå¸ˆè‡³å…³é‡è¦ã€‚éšç€ä¿¡æ¯æŠ€æœ¯çš„è¿›æ­¥ï¼Œç‰¹åˆ«æ˜¯äº’è”ç½‘å’Œå¤§æ•°æ®æŠ€æœ¯çš„å‘å±•ï¼ŒæŠ•èµ„è€…å¯ä»¥å®æ—¶è·å¾—å¤§é‡çš„è‚¡ç¥¨å¸‚åœºä¿¡æ¯ã€‚ç„¶è€Œï¼Œè¿™äº›ä¿¡æ¯é€šå¸¸ä»¥åŸå§‹æ•°æ®å½¢å¼å­˜åœ¨ï¼Œéœ€è¦è¿›ä¸€æ­¥å¤„ç†å’Œåˆ†ææ‰èƒ½æå–æœ‰ä»·å€¼çš„æ´è§ã€‚åœ¨è¿™ç§èƒŒæ™¯ä¸‹ï¼Œç½‘ç»œè‚¡ç¥¨ä¿¡æ¯çˆ¬è™«ä¸å¯è§†åŒ–æŠ€æœ¯åº”è¿è€Œç”Ÿï¼Œæˆä¸ºè‚¡ç¥¨å¸‚åœºåˆ†æçš„é‡è¦å·¥å…·ã€‚</p>
<h2 id="ç½‘ç»œè‚¡ç¥¨ä¿¡æ¯çˆ¬è™«"><a href="#ç½‘ç»œè‚¡ç¥¨ä¿¡æ¯çˆ¬è™«" class="headerlink" title="ç½‘ç»œè‚¡ç¥¨ä¿¡æ¯çˆ¬è™«"></a>ç½‘ç»œè‚¡ç¥¨ä¿¡æ¯çˆ¬è™«</h2><p>ç½‘ç»œè‚¡ç¥¨ä¿¡æ¯çˆ¬è™«ï¼ˆWeb Scrapingï¼‰æ˜¯ä¸€ç§è‡ªåŠ¨åŒ–çš„æ•°æ®æ”¶é›†æŠ€æœ¯ï¼Œæ—¨åœ¨ä»äº’è”ç½‘ä¸Šæå–è‚¡ç¥¨å¸‚åœºç›¸å…³çš„ä¿¡æ¯ã€‚å®ƒåˆ©ç”¨ç¨‹åºåŒ–æ–¹æ³•è®¿é—®å’ŒæŠ“å–å„ç§é‡‘èç½‘ç«™å’Œæ–°é—»å¹³å°ä¸Šçš„æ•°æ®ï¼Œä¾‹å¦‚è‚¡ç¥¨ä»·æ ¼ã€äº¤æ˜“é‡ã€å…¬å¸è´¢æŠ¥ã€æ–°é—»åŠ¨æ€ç­‰ã€‚çˆ¬è™«æŠ€æœ¯å¯ä»¥é«˜æ•ˆåœ°ä»å¤§è§„æ¨¡æ•°æ®æºä¸­è·å–æœ€æ–°çš„ä¿¡æ¯ï¼Œæ”¯æŒå®æ—¶æ•°æ®æ›´æ–°å’Œå†å²æ•°æ®å›æº¯åˆ†æã€‚</p>
<p><strong>å…³é”®æŠ€æœ¯</strong>:</p>
<ul>
<li>çˆ¬è™«æ¡†æ¶ï¼šå¦‚<code>Scrapy</code>ã€<code>BeautifulSoup</code>ç­‰ï¼Œç”¨äºè§£æHTMLé¡µé¢å’Œæå–æ•°æ®ã€‚<ul>
<li><em>ç”±äºæœ¬æ–‡çš„ç›®æ ‡ç½‘ç«™çš„è‚¡ç¥¨æ•°æ®å¹¶ä¸åœ¨é¡µé¢ä¸­ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸éœ€è¦åšç½‘é¡µåˆ†æå’Œæå–</em></li>
</ul>
</li>
<li>APIæ¥å£ï¼šä¸€äº›é‡‘èç½‘ç«™æä¾›APIæ¥å£ï¼Œå…è®¸ç¨‹åºç›´æ¥è·å–ç»“æ„åŒ–çš„æ•°æ®ã€‚<ul>
<li>(ä¾‹å¦‚æœ¬æ–‡ä½¿ç”¨<code>Get</code>æ–¹æ³•çš„httpsè¯·æ±‚ï¼Œè·å–äº†<code>json</code>æ–‡ä»¶)</li>
</ul>
</li>
<li>æ•°æ®å­˜å‚¨ï¼šæŠ“å–çš„æ•°æ®é€šå¸¸éœ€è¦å­˜å‚¨åœ¨æ•°æ®åº“ä¸­ï¼Œå¦‚<code>MySQL</code>ã€<code>MongoDB</code>ç­‰ï¼Œä»¥ä¾¿åç»­åˆ†æå’Œå¤„ç†ã€‚<ul>
<li>(æœ¬æ–‡ä½¿ç”¨ä½œè€…ä¸ªäººæœåŠ¡å™¨ä¸ŠMYSQLä½œä¸ºå­˜å‚¨æ•°æ®åº“)</li>
</ul>
</li>
</ul>
<h2 id="æ•°æ®å¯è§†åŒ–"><a href="#æ•°æ®å¯è§†åŒ–" class="headerlink" title="æ•°æ®å¯è§†åŒ–"></a>æ•°æ®å¯è§†åŒ–</h2><p>æ•°æ®å¯è§†åŒ–æ˜¯å°†å¤æ‚çš„è‚¡ç¥¨å¸‚åœºæ•°æ®ä»¥å›¾å½¢åŒ–çš„æ–¹å¼å‘ˆç°å‡ºæ¥ï¼Œä½¿å¾—æ•°æ®æ›´æ˜“äºç†è§£å’Œåˆ†æã€‚é€šè¿‡å¯è§†åŒ–æŠ€æœ¯ï¼ŒæŠ•èµ„è€…å¯ä»¥ç›´è§‚åœ°è§‚å¯Ÿè‚¡ç¥¨ä»·æ ¼è¶‹åŠ¿ã€äº¤æ˜“é‡å˜åŒ–ã€å¸‚åœºæ³¢åŠ¨ç­‰é‡è¦ä¿¡æ¯ï¼Œä»è€Œåšå‡ºæ›´åŠ æ˜æ™ºçš„æŠ•èµ„å†³ç­–ã€‚</p>
<p><strong>å¸¸ç”¨å¯è§†åŒ–æ–¹æ³•</strong>:</p>
<ul>
<li>æ—¶é—´åºåˆ—å›¾ï¼šç¤ºè‚¡ç¥¨ä»·æ ¼æˆ–äº¤æ˜“é‡éšæ—¶é—´å˜åŒ–çš„è¶‹åŠ¿ã€‚</li>
<li>èœ¡çƒ›å›¾ï¼ˆCandlestickChartï¼‰:ç”¨äºè‚¡ç¥¨ä»·æ ¼åœ¨ä¸€å®šæ—¶é—´å†…çš„å¼€ç›˜ã€æ”¶ç›˜ã€æœ€é«˜å’Œæœ€ä½ä»·æ ¼ã€‚<ul>
<li>åˆç§°<code>Kå›¾</code>ï¼Œæ–‡æœ¬å°±æ˜¯ä½¿ç”¨Kå›¾ä½œä¸ºå¯è§†åŒ–æ–¹å¼</li>
</ul>
</li>
<li>çƒ­åŠ›å›¾ï¼ˆHeatmapï¼‰:ç”¨é¢œè‰²å¼ºåº¦è¡¨ç¤ºä¸åŒè‚¡ç¥¨çš„è¡¨ç°æˆ–å¸‚åœºçš„çƒ­ç‚¹åŒºåŸŸã€‚</li>
<li>æ•£ç‚¹å›¾å’ŒæŠ˜çº¿å›¾ï¼šç”¨äºå±•ç¤ºå¤šç»´æ•°æ®ä¹‹é—´çš„å…³ç³»å’Œè¶‹åŠ¿ã€‚</li>
</ul>
<h2 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h2><p>ç½‘ç»œè‚¡ç¥¨ä¿¡æ¯çˆ¬è™«ä¸å¯è§†åŒ–æŠ€æœ¯åœ¨é‡‘èå¸‚åœºåˆ†æä¸­å…·æœ‰å¹¿æ³›çš„åº”ç”¨ã€‚å®ƒä»¬ä¸ä»…å¯ä»¥å¸®åŠ©æŠ•èµ„è€…å®æ—¶ç›‘æ§å¸‚åœºåŠ¨æ€ï¼Œè¿˜èƒ½å¤Ÿé€šè¿‡å†å²æ•°æ®åˆ†æé¢„æµ‹æœªæ¥è¶‹åŠ¿ã€‚æ­¤å¤–ï¼Œè¿™äº›æŠ€æœ¯è¿˜è¢«ç”¨äºé‡åŒ–åˆ†æã€ç®—æ³•äº¤æ˜“ã€é£é™©ç®¡ç†ç­‰é¢†åŸŸï¼Œä»¥æé«˜æŠ•èµ„å†³ç­–çš„ç§‘å­¦æ€§å’Œå‡†ç¡®æ€§ã€‚  </p>
<p>ç½‘ç»œè‚¡ç¥¨ä¿¡æ¯çˆ¬è™«ä¸å¯è§†åŒ–æŠ€æœ¯ä¸ºç°ä»£é‡‘èå¸‚åœºæä¾›äº†å¼ºå¤§çš„æ•°æ®æ”¯æŒå’Œåˆ†æå·¥å…·ã€‚é€šè¿‡è‡ªåŠ¨åŒ–æ•°æ®æŠ“å–å’Œå›¾å½¢åŒ–å‘ˆç°ï¼ŒæŠ•èµ„è€…å¯ä»¥æ›´é«˜æ•ˆåœ°è·å–å¸‚åœºä¿¡æ¯å’Œæ´å¯Ÿï¼Œæœ‰åŠ©äºåšå‡ºæ›´å‡†ç¡®çš„æŠ•èµ„å†³ç­–ã€‚éšç€æŠ€æœ¯çš„ä¸æ–­å‘å±•ï¼Œè¿™äº›å·¥å…·å°†åœ¨é‡‘èåˆ†æä¸­å‘æŒ¥è¶Šæ¥è¶Šé‡è¦çš„ä½œç”¨ã€‚</p>
<h2 id="ä¸šåŠ¡æµç¨‹å›¾"><a href="#ä¸šåŠ¡æµç¨‹å›¾" class="headerlink" title="ä¸šåŠ¡æµç¨‹å›¾"></a>ä¸šåŠ¡æµç¨‹å›¾</h2><p><img src="https://picbed0521.oss-cn-shanghai.aliyuncs.com/blogpic/OLSIC_flowchart.png"></p>
<h1 id="ä»£ç å®ç°ä¸šåŠ¡åŠŸèƒ½"><a href="#ä»£ç å®ç°ä¸šåŠ¡åŠŸèƒ½" class="headerlink" title="ä»£ç å®ç°ä¸šåŠ¡åŠŸèƒ½"></a>ä»£ç å®ç°ä¸šåŠ¡åŠŸèƒ½</h1><h2 id="ä»£ç æ¡†æ¶"><a href="#ä»£ç æ¡†æ¶" class="headerlink" title="ä»£ç æ¡†æ¶"></a>ä»£ç æ¡†æ¶</h2><ul>
<li>ç½‘ç»œçˆ¬è™«<ul>
<li>ä½¿ç”¨<code>requests</code>æ¨¡å—å‘ç½‘ç«™å‘é€å®šåˆ¶çš„<code>https</code>è¯·æ±‚</li>
<li>ä½¿ç”¨<code>json</code>å¤„ç†ç½‘ç«™è¿”å›çš„<code>json</code>æ•°æ®</li>
<li>çˆ¬è™«éƒ¨åˆ†çš„ä»£ç å°è£…åœ¨<code>SnowBallCrawler.pyä¸­</code></li>
</ul>
</li>
<li>æ•°æ®åº“æŒä¹…åŒ–<ul>
<li>åœ¨<code>mysql</code>ä¸­åˆ›å»ºé¡¹ç›®æ‰€éœ€çš„æ•°æ®åº“å’Œè¡¨</li>
<li>ä½¿ç”¨<code>pymysql</code>æ¨¡å—è¿æ¥æ•°æ®åº“å¹¶æ‰§è¡Œæ’å…¥å’ŒæŸ¥è¯¢æ“ä½œ</li>
</ul>
</li>
<li>GUIå¯è§†åŒ–<ul>
<li>ä½¿ç”¨<code>dearpygui</code>æ¨¡å—å®ç°GUIå¯è§†åŒ–å¹¶ç®¡ç†ç»„ä»¶</li>
<li>ä½¿ç”¨<code>dearpygui</code>çš„ç»Ÿè®¡å›¾ç»˜åˆ¶åŠŸèƒ½ç»˜åˆ¶<code>Kå›¾</code></li>
<li>é¡¹ç›®çš„ä¸»è¦é€»è¾‘é›†æˆåœ¨å¯è§†åŒ–ä»£ç çš„ä¸»è¦éƒ¨åˆ†</li>
<li>å°†è‡ªå®šä¹‰çš„å¤æ‚ç»„ä»¶å°è£…åœ¨ç±»é‡Œ</li>
</ul>
</li>
</ul>
<h2 id="ç½‘ç»œçˆ¬è™«"><a href="#ç½‘ç»œçˆ¬è™«" class="headerlink" title="ç½‘ç»œçˆ¬è™«"></a>ç½‘ç»œçˆ¬è™«</h2><p>æˆ‘ä»¬é¦–å…ˆæ¥å®ç°ç½‘ç»œçˆ¬è™«éƒ¨åˆ†ï¼Œè¿™é‡Œçš„ç›®æ ‡ç½‘ç«™æ˜¯<a target="_blank" rel="noopener" href="https://xueqiu.com/S/SH600519">é›ªçƒç½‘ç«™çš„èŒ…å°è‚¡ç¥¨</a></p>
<h3 id="ç½‘é¡µåˆ†æ"><a href="#ç½‘é¡µåˆ†æ" class="headerlink" title="ç½‘é¡µåˆ†æ"></a>ç½‘é¡µåˆ†æ</h3><p>ä¸€èˆ¬è‚¡ç¥¨ç½‘ç«™çš„æ•°æ®ä¸ä¼šç›´æ¥æ”¾åœ¨åŸå§‹çš„<code>https</code>è¯·æ±‚çš„å“åº”ä¸­ï¼Œæ‰€ä»¥è¦æ‰“å¼€<code>F12</code>åˆ†æç½‘ç«™çš„äºŒæ¬¡è¯·æ±‚çš„å†…å®¹ï¼Œæ–¹æ³•æœ‰ä¸¤ç§:</p>
<p><strong>æ–¹æ³•ä¸€å¦‚å›¾</strong>:</p>
<ol>
<li>æŒ‰ä¸‹<code>f12</code>æ‰“å¼€ç½‘é¡µåˆ†æå™¨</li>
<li>ç‚¹å‡»é€‰é¡¹å¡ä¸­çš„<code>ç½‘ç»œ(Network)</code>åˆ‡æ¢åˆ°å¯¹åº”çš„é¡µé¢,å¹¶é€‰ä¸­ä¸‹æ–¹çš„<code>Fetch/XHR</code>åˆ†ç±»å¡</li>
<li>åˆ·æ–°ç½‘é¡µï¼Œå¹¶ç‚¹å‡»ç½‘ç«™ä¸­çš„<code>æ—¥K</code>é€‰é¡¹ï¼Œé¼ æ ‡æ‚¬åœåœ¨æŸä¸€å¤©çš„çº¿ä¸Š</li>
<li>ä»æ‚¬åœæç¤ºçš„æ•°å­—ä¸­é€‰ä¸€ä¸ªæ¯”è¾ƒæœ‰å”¯ä¸€æ€§çš„ï¼ˆæ¯”å¦‚æ”¶ç›˜ä»·ï¼‰,åœ¨æœç´¢ä¸­å¡«å…¥é€‰ä¸­çš„æ•°å­—</li>
<li>ä¸€èˆ¬è¿™æ ·å°±èƒ½é€‰å‡ºå”¯ä¸€çš„å“åº”äº†ï¼Œé‡Œé¢å°±å­˜ç€æˆ‘ä»¬æ‰€éœ€è¦çš„æ•°æ®ï¼ˆæˆ‘ä»¬è¿™ä¸ªä¾‹å­å°±æœ‰280å¤šæ¡æ•°æ®ï¼‰</li>
</ol>
<p><img src="https://picbed0521.oss-cn-shanghai.aliyuncs.com/blogpic/OLSIC_page1.png"></p>
<p><strong>æ–¹æ³•äºŒ</strong></p>
<p>å¦‚æœæ–¹æ³•ä¸€æœç´¢ä¸å‡ºæ¥ï¼Œè¿˜å¯ä»¥ä½¿ç”¨é™å®šæŠ“åŒ…æ—¶é—´çš„æ–¹æ³•ï¼Œå‡å°æœç´¢èŒƒå›´</p>
<ol>
<li>æŒ‰ä¸‹<code>f12</code>æ‰“å¼€ç½‘é¡µåˆ†æå™¨</li>
<li>ç‚¹å‡»é€‰é¡¹å¡ä¸­çš„<code>ç½‘ç»œ(Network)</code>åˆ‡æ¢åˆ°å¯¹åº”çš„é¡µé¢,å¹¶é€‰ä¸­ä¸‹æ–¹çš„<code>Fetch/XHR</code>åˆ†ç±»å¡</li>
<li>åˆ·æ–°ç½‘é¡µï¼Œç­‰å¾…ç½‘é¡µå®Œå…¨åŠ è½½åï¼Œå†æ¥å›åˆ‡æ¢<code>æ—¥K</code>å’Œ<code>å‘¨Kï¼ˆæˆ–å…¶å®ƒç±»ä¼¼é€‰é¡¹å¡ï¼‰</code>,è§‚å¯Ÿæ—¶é—´è½´çª—å£çš„å˜åŒ–</li>
<li>æœ€åç‚¹å‡»<code>æ—¥K</code>é€‰é¡¹å¡ï¼Œåœ¨æ—¶é—´è½´çª—å£å•å‡»å‘ç”Ÿå˜åŒ–çš„åœ°æ–¹ï¼Œç„¶åè°ƒæ•´è§‚å¯ŸåŒºé—´</li>
<li>æœç´¢ç­›é€‰å‡ºæ¥çš„å“åº”</li>
</ol>
<p><img src="https://picbed0521.oss-cn-shanghai.aliyuncs.com/blogpic/202410091905283.gif"></p>
<hr>
<p>å¦‚å›¾ï¼Œæˆ‘ä»¬æ‰¾åˆ°äº†æƒ³è¦çš„å“åº”ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬åˆ†ææ ‡å¤´<code>header</code>,æ¥ä¸‹æ¥ç‚¹å‡»æ ‡å¤´é€‰é¡¹å¡</p>
<ul>
<li>è¯·æ±‚<code>URL</code></li>
</ul>
<p><img src="https://picbed0521.oss-cn-shanghai.aliyuncs.com/blogpic/OLSIC_header.png"></p>
<p>å¦‚å›¾ï¼Œç›®æ ‡ç½‘ç«™ä½¿ç”¨äº†<code>GET</code>æ–¹æ³•è¯·æ±‚æ•°æ®ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦ç€é‡åˆ†æ<code>GET</code>æ–¹æ³•çš„<code>å‚æ•°</code>å’Œ<code>æ— å‚URL</code>(ç”¨äºæ‹¼æ¥è¯·æ±‚URL)ï¼Œè€Œå‚æ•°å°±åœ¨<code>URL</code>ä¸­</p>
<p>æ‹†åˆ†å‚æ•°å¹¶è½¬æ¢æˆpythonå­—å…¸åå¦‚ä¸‹</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">param_data = &#123;</span><br><span class="line">            <span class="string">&#x27;symbol&#x27;</span>:<span class="string">&#x27;SH600519&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;begin&#x27;</span>:<span class="number">1726713214191</span>,</span><br><span class="line">            <span class="string">&#x27;period&#x27;</span>:<span class="string">&#x27;day&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;type&#x27;</span>:<span class="string">&#x27;before&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;count&#x27;</span>:<span class="string">&#x27;-284&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;indicator&#x27;</span>:<span class="string">&#x27;kline,pe,pb,ps,pcf,market_capital,agt,ggt,balance&#x27;</span></span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>
<p>å¾ˆæ˜æ˜¾ï¼Œ<code>begin</code>æ˜¯æ—¶é—´æˆ³ï¼Œç”¨äºè¯·æ±‚æœ€æ–°çš„æ•°æ®,ä½†æ˜¯æ¯”è¾ƒç‰¹åˆ«çš„ï¼Œç½‘ç«™ç”¨çš„æ˜¯<code>æ•´æ•°çš„æ¯«ç§’çº§æ—¶é—´æˆ³</code>,åœ¨pythonä¸­ä½¿ç”¨timeæ¨¡å—ä¼ å½“å‰çš„<code>begin</code>å€¼æ—¶å¾—æ³¨æ„</p>
<p>å› ä¸ºæœ¬é¡¹ç›®åªçˆ¬å–ä¸€æ”¯è‚¡ç¥¨çš„ä¿¡æ¯ï¼Œå‰©ä¸‹çš„å‚æ•°ä¸ä½œè§£æ</p>
<ul>
<li>æ ‡å¤´(<code>header</code>)</li>
</ul>
<p>ä¸ºäº†é˜²æ­¢è¢«ç½‘ç«™çš„åçˆ¬å–ç»™æ‹¦æˆªä¸‹æ¥ï¼Œæ ‡å¤´éœ€è¦å’Œè‡ªå·±åœ¨ç½‘ç«™é‡ŒæŸ¥åˆ°çš„ä¿æŒä¸€è‡´</p>
<p>è½¬æˆpythonå­—å…¸çš„ä»£ç å¦‚ä¸‹</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">self</span>.headers = &#123;</span><br><span class="line">            <span class="string">&#x27;Accept&#x27;</span>:<span class="string">&#x27;application/json, text/plain, */*&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;Accept-Encoding&#x27;</span>:<span class="string">&#x27;gzip, deflate, br, zstd&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;Accept-Language&#x27;</span>:<span class="string">&#x27;zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;Cookie&#x27;</span>:<span class="string">&#x27;è¯·ä½¿ç”¨è‡ªå·±çš„Cookie,æœ¬æ–‡ä½œè€…å·²éšå»&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;Origin&#x27;</span>:<span class="string">&#x27;https://xueqiu.com&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;Priority&#x27;</span>:<span class="string">&#x27;u=1, i&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;Referer&#x27;</span>:<span class="string">&#x27;https://xueqiu.com/S/SH600519&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;Sec-Ch-Ua&#x27;</span>:<span class="string">&#x27;&quot;Not/A)Brand&quot;;v=&quot;8&quot;, &quot;Chromium&quot;;v=&quot;126&quot;, &quot;Microsoft Edge&quot;;v=&quot;126&quot;&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;sec-ch-ua-mobile&#x27;</span>:<span class="string">&#x27;?0&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;sec-ch-ua-platform&#x27;</span>:<span class="string">&#x27;&quot;Windows&quot;&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;Sec-Fetch-Dest&#x27;</span>:<span class="string">&#x27;empty&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;Sec-Fetch-Mode&#x27;</span>:<span class="string">&#x27;cors&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;Sec-Fetch-Site&#x27;</span>:<span class="string">&#x27;same-site&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;User-Agent&#x27;</span>:<span class="string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/126.0.0.0 Safari/537.36 Edg/126.0.0.0&#x27;</span></span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>

<h3 id="å°è£…ç±»"><a href="#å°è£…ç±»" class="headerlink" title="å°è£…ç±»"></a>å°è£…ç±»</h3><p>å› ä¸ºåªçˆ¬å–ä¸€æ”¯è‚¡ç¥¨ï¼Œå°±ä¸å°è£…é€šç”¨æ€§å¼ºçš„ç±»äº†ï¼Œè€Œæ˜¯åªé’ˆå¯¹è¿™ä¸€æ”¯è‚¡ç¥¨ï¼Œæ‰€ä»¥å°è£…ä¸€ä¸ª<code>GZMaoTai</code>ç±»,å¹¶æä¾›<code>get_response</code>æ¥å£ï¼Œå‘å¤–ç•Œä¼ é€æ¯æ¬¡çˆ¬å–çš„æ•°æ®ã€‚å…¶ä¸­å¯¹è¿”å›çš„josonæ ¼å¼çš„å­—ç¬¦ä¸²ï¼Œä½¿ç”¨<code>Josn</code>æ¨¡å—å°†å…¶ååºåˆ—åŒ–ï¼Œå¹¶å‚¨å­˜åœ¨Pythonåˆ—è¡¨ä¸­è¿”å›</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">GZMaoTai</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line"></span><br><span class="line">        <span class="variable language_">self</span>.url = <span class="string">&#x27;https://stock.xueqiu.com/v5/stock/chart/kline.json&#x27;</span></span><br><span class="line">        <span class="variable language_">self</span>.headers = &#123;</span><br><span class="line">            <span class="string">&#x27;Accept&#x27;</span>:<span class="string">&#x27;application/json, text/plain, */*&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;Accept-Encoding&#x27;</span>:<span class="string">&#x27;gzip, deflate, br, zstd&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;Accept-Language&#x27;</span>:<span class="string">&#x27;zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;Cookie&#x27;</span>:<span class="string">&#x27;è¯·ä½¿ç”¨è‡ªå·±çš„Cookie,æœ¬æ–‡ä½œè€…å·²éšå»&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;Origin&#x27;</span>:<span class="string">&#x27;https://xueqiu.com&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;Priority&#x27;</span>:<span class="string">&#x27;u=1, i&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;Referer&#x27;</span>:<span class="string">&#x27;https://xueqiu.com/S/SH600519&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;Sec-Ch-Ua&#x27;</span>:<span class="string">&#x27;&quot;Not/A)Brand&quot;;v=&quot;8&quot;, &quot;Chromium&quot;;v=&quot;126&quot;, &quot;Microsoft Edge&quot;;v=&quot;126&quot;&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;sec-ch-ua-mobile&#x27;</span>:<span class="string">&#x27;?0&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;sec-ch-ua-platform&#x27;</span>:<span class="string">&#x27;&quot;Windows&quot;&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;Sec-Fetch-Dest&#x27;</span>:<span class="string">&#x27;empty&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;Sec-Fetch-Mode&#x27;</span>:<span class="string">&#x27;cors&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;Sec-Fetch-Site&#x27;</span>:<span class="string">&#x27;same-site&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;User-Agent&#x27;</span>:<span class="string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/126.0.0.0 Safari/537.36 Edg/126.0.0.0&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_response</span>(<span class="params">self,date</span>):</span><br><span class="line">        nowtime = <span class="built_in">int</span>(time.time() * <span class="number">1000.0</span>)</span><br><span class="line">        param_data = &#123;</span><br><span class="line">            <span class="string">&#x27;symbol&#x27;</span>:<span class="string">&#x27;SH600519&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;begin&#x27;</span>:<span class="built_in">str</span>(nowtime),</span><br><span class="line">            <span class="string">&#x27;period&#x27;</span>:<span class="string">&#x27;day&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;type&#x27;</span>:<span class="string">&#x27;before&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;count&#x27;</span>:<span class="string">&#x27;-284&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;indicator&#x27;</span>:<span class="string">&#x27;kline,pe,pb,ps,pcf,market_capital,agt,ggt,balance&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;å¼€å§‹çˆ¬å–æ•°æ®&quot;</span>)</span><br><span class="line">        response = requests.get(<span class="variable language_">self</span>.url,headers=<span class="variable language_">self</span>.headers,params=param_data,timeout=<span class="number">5</span>)</span><br><span class="line">        <span class="built_in">print</span>(response.text)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;çˆ¬å–æˆåŠŸï¼Œæ•°æ®åŒ…å¦‚ä¸Š&quot;</span>)</span><br><span class="line"></span><br><span class="line">        data_json = json.loads(response.text)  <span class="comment"># Jsonååºåˆ—åŒ–</span></span><br><span class="line">        items = data_json[<span class="string">&#x27;data&#x27;</span>][<span class="string">&#x27;item&#x27;</span>]</span><br><span class="line">        <span class="comment"># for i in range(len(items)):</span></span><br><span class="line">        <span class="comment"># print(items[i])</span></span><br><span class="line">        <span class="comment"># jsonæ•°æ®å¯¹åº”</span></span><br><span class="line">        <span class="comment"># [0] timestamp</span></span><br><span class="line">        <span class="comment"># [1] æˆäº¤é‡</span></span><br><span class="line">        <span class="comment"># [2] å¼€ç›˜ä»·</span></span><br><span class="line">        <span class="comment"># [3] æœ€é«˜ä»·</span></span><br><span class="line">        <span class="comment"># [4] æœ€ä½ä»·</span></span><br><span class="line">        <span class="comment"># [5] æ”¶ç›˜ä»·</span></span><br><span class="line">        <span class="comment"># [6] æ¶¨è·Œé¢</span></span><br><span class="line">        <span class="comment"># [7] æ¶¨è·Œå¹…</span></span><br><span class="line">        <span class="comment"># [8] æ¢æ‰‹ç‡</span></span><br><span class="line">        <span class="comment"># [9] æˆäº¤é¢(äº¿)</span></span><br><span class="line">        <span class="comment"># [10] null</span></span><br><span class="line">        <span class="comment"># [11] null</span></span><br><span class="line">        <span class="comment"># [12]</span></span><br><span class="line">        <span class="keyword">return</span> items</span><br></pre></td></tr></table></figure>
<h2 id="æ•°æ®åº“æŒä¹…åŒ–"><a href="#æ•°æ®åº“æŒä¹…åŒ–" class="headerlink" title="æ•°æ®åº“æŒä¹…åŒ–"></a>æ•°æ®åº“æŒä¹…åŒ–</h2><h3 id="æ•°æ®åº“å‡†å¤‡"><a href="#æ•°æ®åº“å‡†å¤‡" class="headerlink" title="æ•°æ®åº“å‡†å¤‡"></a>æ•°æ®åº“å‡†å¤‡</h3><p>è¿™é‡Œä½¿ç”¨è¿œç«¯çš„<code>MYSQL</code>ç®¡ç†æ•°æ®åº“,ä½œè€…ä½¿ç”¨äº†è‡ªå·±çš„æœåŠ¡å™¨,å…·ä½“çš„é…ç½®å’Œå®‰è£…ä¸ä½œä»‹ç»ã€‚</p>
<ol>
<li>æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªç”¨äºå­˜å‚¨è‚¡ç¥¨è¡¨çš„æ•°æ®åº“<code>stock</code></li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">create database if not exists stock</span><br></pre></td></tr></table></figure>

<ol start="2">
<li><p>æˆ‘ä»¬é’ˆå¯¹æœ¬æ¬¡å®éªŒï¼Œå†åˆ›å»ºä¸€ä¸ª<code>MaoTai</code>è¡¨ã€‚ï¼ˆè‹¥è¦è‡ªåŠ¨å»ºè¡¨ï¼Œåˆ™è¿™éƒ¨åˆ†åœ¨ä»£ç å®ç°ï¼‰</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">create table MaoTai(</span><br><span class="line">    timesamp bigint not null,</span><br><span class="line">    volume int not null,</span><br><span class="line">    open decimal(8,4) not null,</span><br><span class="line">    high decimal(8,4) not null,</span><br><span class="line">    low decimal(8,4) not null,</span><br><span class="line">    close decimal(8,4) not null,</span><br><span class="line">    chg decimal(8,4) not null,</span><br><span class="line">    percent decimal(8,4) not null,</span><br><span class="line">    turnoverrate decimal(8,4) not null,</span><br><span class="line">    amount decimal(12,1) not null</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<p>ç‰¹åˆ«è¯´æ˜åœ°ï¼Œè¿™è¾¹çš„<code>timesamp</code>æ˜¯æ‹¼å†™é”™è¯¯ğŸ˜…,è¿™ä¸ªè¡¨ç»“æ„ä¸æ˜¯ç‰¹åˆ«å¥½çœ‹ï¼Œä¹Ÿæ²¡æœ‰è®¾ç½®ä¸»é”®ï¼Œ<del>äº²èº«å®è·µï¼Œæ—¶é—´æˆ³å¤ªå¤§äº†ï¼Œä¸èƒ½ä½œä¸ºä¸»é”®ï¼Œå¦åˆ™è¿™ä¸ªè¡¨çš„å¢åˆ æŸ¥æ”¹ä¼šè¶…æ—¶</del></p>
</li>
<li><p>æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªä¸“é—¨ç®¡ç†è‚¡ç¥¨æ•°æ®åº“çš„è¿œç¨‹ç™»å½•è´¦æˆ·<code>supdiver</code>,å¹¶æŠŠç”¨æˆ·æƒé™é™å®šåœ¨<code>stock.MaoTai</code>è¡¨ä¸Š</p>
</li>
</ol>
<p>Mysql8.0è¯­æ³•</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">create user supdriver@% identified by &#x27;å¯†ç &#x27;ï¼›</span><br><span class="line"></span><br><span class="line">grant all privileges on stock.MaoTai to supdriver@%</span><br></pre></td></tr></table></figure>

<h3 id="ä»£ç å°è£…"><a href="#ä»£ç å°è£…" class="headerlink" title="ä»£ç å°è£…"></a>ä»£ç å°è£…</h3><p>å¯¹äºæ•°æ®åº“çš„æ“ä½œä¸»è¦æ˜¯å°è£…å‡ ä¸ªæ¥å£ï¼Œæ‰€ä»¥å°±ç›´æ¥æŠŠæœ‰å…³çš„å‡½æ•°å£°æ˜åœ¨<code>DBManager.py</code>æ¨¡å—ä¸­ï¼Œè€Œä¸å°è£…æˆç±»äº†ã€‚</p>
<p>ä¸»è¦æ“ä½œå°±æ˜¯è¿æ¥åˆ°æ•°æ®åº“ï¼Œç„¶ååˆ›å»º<code>cursor</code>æŒ‡é’ˆç”¨äºæ‰§è¡Œ<code>mysql</code>è¯­å¥å¹¶è·å–è¿”å›å€¼</p>
<p><em>æ³¨:hostä¸ºmysqlæ‰€åœ¨æœåŠ¡å™¨çš„å…¬æœ‰ip,æœ¬æ–‡å°†ä½œè€…è‡ªå·±æœåŠ¡å™¨çš„å®é™…ipæ”¹æˆäº†æœ¬åœ°è·¯ç”±ç¯å›çš„127.0.0.1</em></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pymysql</span><br><span class="line"></span><br><span class="line">stockDB = pymysql.Connect(</span><br><span class="line">    host=<span class="string">&#x27;47.99.48.121&#x27;</span>,</span><br><span class="line">    port=<span class="number">3306</span>,</span><br><span class="line">    user=<span class="string">&#x27;supdriver&#x27;</span>,</span><br><span class="line">    password=<span class="string">&#x27;&#x27;</span>,</span><br><span class="line">    db=<span class="string">&#x27;stock&#x27;</span>,</span><br><span class="line">    charset=<span class="string">&#x27;utf8&#x27;</span>,</span><br><span class="line">    autocommit=<span class="literal">True</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sendData</span>(<span class="params">items</span>):</span><br><span class="line">    stockDB.ping(reconnect=<span class="literal">True</span>)</span><br><span class="line">    cursor = stockDB.cursor()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;å¼€å§‹å‘æ•°æ®åº“æ’å…¥æ•°æ®&quot;</span>)</span><br><span class="line">    <span class="keyword">for</span> item <span class="keyword">in</span> items:</span><br><span class="line">        sql=(<span class="string">f&quot;insert into MaoTai values (<span class="subst">&#123;item[<span class="number">0</span>]&#125;</span>,&quot;</span></span><br><span class="line">             <span class="string">f&quot;<span class="subst">&#123;item[<span class="number">1</span>]&#125;</span>,&quot;</span></span><br><span class="line">             <span class="string">f&quot;<span class="subst">&#123;item[<span class="number">2</span>]&#125;</span>,&quot;</span></span><br><span class="line">             <span class="string">f&quot;<span class="subst">&#123;item[<span class="number">3</span>]&#125;</span>,&quot;</span></span><br><span class="line">             <span class="string">f&quot;<span class="subst">&#123;item[<span class="number">4</span>]&#125;</span>,&quot;</span></span><br><span class="line">             <span class="string">f&quot;<span class="subst">&#123;item[<span class="number">5</span>]&#125;</span>,&quot;</span></span><br><span class="line">             <span class="string">f&quot;<span class="subst">&#123;item[<span class="number">6</span>]&#125;</span>,&quot;</span></span><br><span class="line">             <span class="string">f&quot;<span class="subst">&#123;item[<span class="number">7</span>]&#125;</span>,&quot;</span></span><br><span class="line">             <span class="string">f&quot;<span class="subst">&#123;item[<span class="number">8</span>]&#125;</span>,&quot;</span></span><br><span class="line">             <span class="string">f&quot;<span class="subst">&#123;item[<span class="number">9</span>]&#125;</span>);&quot;</span>)</span><br><span class="line">        <span class="comment"># print(sql)</span></span><br><span class="line">        cursor.execute(sql)</span><br><span class="line">        <span class="comment"># print(cursor.fetchall())</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;æ’å…¥æ•°æ®æˆåŠŸï¼Œæ€»è®¡<span class="subst">&#123;<span class="built_in">len</span>(items)&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getAllData</span>(<span class="params">stockDB</span>):</span><br><span class="line">    stockDB.ping(reconnect=<span class="literal">True</span>)</span><br><span class="line">    cursor = stockDB.cursor()</span><br><span class="line">    sql= <span class="string">&quot;select * from MaoTai&quot;</span></span><br><span class="line">    cursor.execute(sql)</span><br><span class="line">    <span class="keyword">return</span> cursor.fetchall()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getLatestData</span>():</span><br><span class="line">    stockDB.ping(reconnect=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">    cursor=stockDB.cursor()</span><br><span class="line">    sql=<span class="string">&quot;select * from MaoTai order by timesamp desc&quot;</span></span><br><span class="line">    cursor.execute(sql)</span><br><span class="line">    alldata = cursor.fetchall()</span><br><span class="line">    resList = []</span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> alldata:</span><br><span class="line">        resList.append(line)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> resList</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">closeDB</span>():</span><br><span class="line">    stockDB.close()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">clearDB</span>():</span><br><span class="line">    stockDB.ping(reconnect=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">    cursor = stockDB.cursor()</span><br><span class="line">    sql=<span class="string">&#x27;delete from MaoTai&#x27;</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;å¼€å§‹æ¸…ç†æ•°æ®åº“&quot;</span>)</span><br><span class="line">    cursor.execute(sql)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;æ¸…ç†å®Œæˆ&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h2 id="GUIå¯è§†åŒ–å’ŒKå›¾ç»˜åˆ¶"><a href="#GUIå¯è§†åŒ–å’ŒKå›¾ç»˜åˆ¶" class="headerlink" title="GUIå¯è§†åŒ–å’ŒKå›¾ç»˜åˆ¶"></a>GUIå¯è§†åŒ–å’ŒKå›¾ç»˜åˆ¶</h2><p>æ¥ä¸‹æ¥å°±æ˜¯æ•´ä¸ªé¡¹ç›®çš„é‡å¤´æˆï¼Œç»è¿‡å‰é¢çš„å°è£…ï¼Œæ•°æ®çš„è·å–ï¼Œå‚¨å­˜å’Œé¢„å¤„ç†å·²ç»å®Œæˆ</p>
<p>æˆ‘ä»¬è¿™é‡Œä½¿ç”¨çš„å¯è§†åŒ–æ¨¡å—å«åš<a target="_blank" rel="noopener" href="https://dearpygui.readthedocs.io/en/latest/index.html#">dearpygui</a>,<em>åé¢ç®€ç§°<code>dpg</code></em></p>
<p>å…³äºå¯è§†åŒ–ç»„ä»¶çš„ä¸Šä¸‹æ–‡ï¼Œå°†äº¤ç”±<code>dearpygui</code>è‡ªåŠ¨ä¸ºç»´æŠ¤,è¿™é‡Œå¯¹<code>dpg</code>ä¸å¤šä½œä»‹ç»ï¼Œå…ˆä»‹ç»æœ€é‡è¦çš„ä¸€ä¸ªæ¦‚å¿µï¼š<code>dpg</code>ä¸­æ‰€æœ‰çš„ç»„ä»¶éƒ½æœ‰è‡ªå·±çš„<code>uuid</code>ç”¨äºç»´æŠ¤ï¼Œå› æ­¤å¯¹ç»„ä»¶çš„ç®¡ç†å°±æ˜¯å¯¹ç»„ä»¶<code>id</code>çš„ç®¡ç†ï¼Œå…¶ä¸­<code>id</code>æ—¢å¯ä»¥æ˜¯æ•´å‹ä¹Ÿå¯ä»¥æ˜¯å­—ç¬¦ä¸²</p>
<h3 id="é¡µé¢è®¾è®¡"><a href="#é¡µé¢è®¾è®¡" class="headerlink" title="é¡µé¢è®¾è®¡"></a>é¡µé¢è®¾è®¡</h3><p>åšå·¥ç¨‹è¦æœ‰è“å›¾ï¼Œåšå¯è§†åŒ–å½“ç„¶è¦æœ‰é¡µé¢è®¾è®¡æ¥æŒ‡å¯¼ä»£ç å®ç°ï¼Œå¦åˆ™æƒ³åˆ°å“ªåšåˆ°å“ªä¼šååˆ†ç¼ºä¹æ•ˆç‡ã€‚æˆ‘ä»¬é¢„æœŸçš„é¡µé¢è®¾è®¡å¦‚ä¸‹</p>
<p><img src="https://picbed0521.oss-cn-shanghai.aliyuncs.com/blogpic/OLSIC_mainDesign01108329.png"></p>
<h3 id="å°è£…ä¸»çª—å£ç±»å¹¶æ˜¾ç¤º"><a href="#å°è£…ä¸»çª—å£ç±»å¹¶æ˜¾ç¤º" class="headerlink" title="å°è£…ä¸»çª—å£ç±»å¹¶æ˜¾ç¤º"></a>å°è£…ä¸»çª—å£ç±»å¹¶æ˜¾ç¤º</h3><p>æ‰€æœ‰çš„dpgçš„å¯è§†åŒ–ç»„ä»¶éœ€è¦åˆ›å»ºåœ¨dpgçš„ä¸Šä¸‹æ–‡ä¸­ï¼Œæ‰€ä»¥è¦å°è£…ç±»ï¼Œå°±å¾—ä½¿ç”¨å…¶æä¾›çš„<code>dpg.stage()</code>æ¥åœ¨ç±»é‡Œåˆ›å»ºä¸´æ—¶ä¸Šä¸‹æ–‡</p>
<blockquote>
<p>DVWrapper.py</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> dearpygui.dearpygui <span class="keyword">as</span> dpg</span><br><span class="line"><span class="keyword">from</span> SnowBallCrawler <span class="keyword">import</span>  *</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Window</span>:</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,label,tag</span>):</span><br><span class="line">        <span class="keyword">with</span> dpg.stage() <span class="keyword">as</span> stage: <span class="comment"># åˆ›å»ºä¸´æ—¶ä¸Šä¸‹æ–‡</span></span><br><span class="line">            <span class="variable language_">self</span>.<span class="built_in">id</span> = dpg.add_window(label=label,tag=tag) <span class="comment"># åœ¨é‡Œé¢åˆ›å»ºä¸€ä¸ªwindowç»„ä»¶</span></span><br><span class="line">        <span class="variable language_">self</span>.stage = stage <span class="comment"># å‚¨å­˜ä¸´æ—¶ä¸Šä¸‹æ–‡çš„id</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">add_child</span>(<span class="params">self,child</span>): <span class="comment"># ç›´æ¥æ·»åŠ å«æœ‰self.idçš„è‡ªå®šä¹‰ç±»ä¸ºå­©å­</span></span><br><span class="line">        dpg.move_item(child.<span class="built_in">id</span>,parent=<span class="variable language_">self</span>.<span class="built_in">id</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">add_childID</span>(<span class="params">self,childID</span>): <span class="comment"># æŒ‰ç…§idæ·»åŠ å­©å­</span></span><br><span class="line">        dpg.move_item(childID,parent=<span class="variable language_">self</span>.<span class="built_in">id</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">submit</span>(<span class="params">self</span>): <span class="comment"># å°†ä¸´æ—¶ä¸Šä¸‹æ–‡åˆå¹¶åˆ°ä¸»dpgä¸Šä¸‹æ–‡,æ•ˆæœä¸Šæ˜¯è®©ç»„ä»¶å¯è§</span></span><br><span class="line">        dpg.unstage(<span class="variable language_">self</span>.stage)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>åœ¨<code>DVWrapper.py</code>ä¸­å°è£…å¥½<code>Window</code>ç±»åï¼Œæˆ‘ä»¬åœ¨<code>DataVisual.py</code>ä¸­åˆ›å»º<code>dpg</code>çš„ä¸Šä¸‹æ–‡å¹¶å°†<code>Window</code>ç±»å®ä¾‹åŒ–å‡ºæ¥</p>
<blockquote>
<p>DataVisual.py</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> DVWrapper <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> DBManager <span class="keyword">as</span> dbm</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">dpg.create_context() <span class="comment"># åˆ›å»ºdpgä¸Šä¸‹æ–‡</span></span><br><span class="line"></span><br><span class="line">main_win = Window(label=<span class="string">&quot;main_win&quot;</span>,tag=<span class="string">&quot;main_win&quot;</span>) <span class="comment"># å®ä¾‹åŒ–</span></span><br><span class="line"></span><br><span class="line">main_win.submit() <span class="comment"># æäº¤ç»„ä»¶</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ä»¥ä¸‹çš„ä»£ç ä¸ºå›ºå®šä»£ç æ¡†æ¶çš„ä¸€éƒ¨åˆ†ï¼Œä¸å¤šä½œè®²è§£</span></span><br><span class="line">dpg.create_viewport(title=<span class="string">&#x27;Custom Title&#x27;</span>, width=<span class="number">1400</span>, height=<span class="number">600</span>)</span><br><span class="line">dpg.setup_dearpygui()</span><br><span class="line">dpg.show_viewport()</span><br><span class="line">dpg.set_primary_window(<span class="string">&quot;main_win&quot;</span>, <span class="literal">True</span>) <span class="comment"># çœŸæ­£è®¾ç½®åˆå§‹çª—å£(å¯é€‰)</span></span><br><span class="line">dpg.start_dearpygui()</span><br><span class="line"></span><br><span class="line">dpg.destroy_context()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="å°è£…å­çª—å£ç±»"><a href="#å°è£…å­çª—å£ç±»" class="headerlink" title="å°è£…å­çª—å£ç±»"></a>å°è£…å­çª—å£ç±»</h3><p>å…‰æœ‰ä¸»çª—å£è¿˜ä¸å¤Ÿï¼Œè¿˜éœ€è¦å­çª—å£æ¥é™åˆ¶æœªæ¥è¦å±•ç¤ºçš„è¡¨æ ¼ï¼Œé˜²æ­¢è¡¨æ ¼è¿‡é•¿ï¼Œå ç”¨ä¸»çª—å£è¿‡å¤šçš„ç©ºé—´</p>
<blockquote>
<p>DVWrapper.py</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Child_Window</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,width=<span class="number">1200</span>,height=<span class="number">300</span>,tag=TOP_CHILD_WINDOW</span>):</span><br><span class="line">        <span class="keyword">with</span> dpg.stage():</span><br><span class="line">            <span class="variable language_">self</span>.<span class="built_in">id</span> = dpg.add_child_window(tag=tag,width=width,height=height)</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">add_child</span>(<span class="params">self,child</span>): <span class="comment"># æä¾›å¢åŠ å­ç»„ä»¶çš„æ¥å£</span></span><br><span class="line">        dpg.move_item(child.<span class="built_in">id</span>,parent=<span class="variable language_">self</span>.<span class="built_in">id</span>)</span><br></pre></td></tr></table></figure>


<h3 id="å°è£…Tableç±»"><a href="#å°è£…Tableç±»" class="headerlink" title="å°è£…Tableç±»"></a>å°è£…Tableç±»</h3><p>æˆ‘ä»¬å°è£…ä¸€ä¸ª<code>Table</code>ç±»æ¥æ‰§è¡Œæ›´æ–°è¡¨æ ¼å’Œæ˜¾ç¤ºè¡¨æ ¼çš„åŠŸèƒ½</p>
<blockquote>
<p>DVWrapper.py</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">mystampToNumStr</span>(<span class="params">stamp</span>): <span class="comment"># å°è£…ä¸€ä¸ªæŠŠæ¯«ç§’çº§æ—¶é—´æˆ³è½¬æ¢æˆå¹´æœˆæ—¥çš„å‡½æ•°</span></span><br><span class="line">    date = time.strftime(<span class="string">&quot;%Y/%m/%d&quot;</span>, time.localtime(<span class="built_in">int</span>(stamp / <span class="number">1000.0</span>)))</span><br><span class="line">    <span class="keyword">return</span> date</span><br><span class="line"></span><br><span class="line">TOP_CHILD_WINDOW = <span class="string">&quot;top_child_win&quot;</span> <span class="comment"># å®šä¹‰é»˜è®¤çš„å­çª—å£id</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å‡†å¤‡ä¸€ä¸ªå‚¨å­˜åˆ—åç§°çš„åˆ—è¡¨ï¼Œæ–¹ä¾¿å»ºç«‹è¡¨æ ¼</span></span><br><span class="line">columns = [<span class="string">&#x27;åºå·&#x27;</span>,<span class="string">&#x27;æ—¶é—´&#x27;</span>,<span class="string">&#x27;æˆäº¤é‡(æ‰‹)&#x27;</span>,<span class="string">&#x27;å¼€ç›˜ä»·&#x27;</span>,<span class="string">&#x27;æœ€é«˜ä»·&#x27;</span>,<span class="string">&#x27;æœ€ä½ä»·&#x27;</span>,<span class="string">&#x27;æ”¶ç›˜ä»·&#x27;</span>,<span class="string">&#x27;æ¶¨è·Œé¢&#x27;</span>,<span class="string">&#x27;æ¶¨è·Œå¹…&#x27;</span>,<span class="string">&#x27;æ¢æ‰‹ç‡&#x27;</span>,<span class="string">&#x27;æˆäº¤é¢(äº¿)&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">DataTable</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,tag=<span class="string">&#x27;main table&#x27;</span></span>):</span><br><span class="line">        <span class="keyword">with</span> dpg.stage(): <span class="comment"># åˆ›å»ºä¸´æ—¶ä¸Šä¸‹æ–‡</span></span><br><span class="line">            <span class="variable language_">self</span>.<span class="built_in">id</span> = dpg.add_table(header_row=<span class="literal">True</span>, policy=dpg.mvTable_SizingFixedFit, row_background=<span class="literal">True</span>, reorderable=<span class="literal">True</span>,</span><br><span class="line">                   resizable=<span class="literal">True</span>, no_host_extendX=<span class="literal">False</span>, hideable=<span class="literal">True</span>,</span><br><span class="line">                   borders_innerV=<span class="literal">True</span>, delay_search=<span class="literal">True</span>, borders_outerV=<span class="literal">True</span>, borders_innerH=<span class="literal">True</span>,</span><br><span class="line">                   borders_outerH=<span class="literal">True</span>,tag=tag)  <span class="comment"># åˆ›å»ºä¸€ä¸ªä¼šè‡ªåŠ¨ä¼¸ç¼©ï¼Œå¯ä¿®æ”¹åˆ—å®½åº¦çš„ï¼Œæ¯”è¾ƒè‡ªç”±çš„è¡¨æ ¼</span></span><br><span class="line"></span><br><span class="line">            dpg.push_container_stack(<span class="variable language_">self</span>.<span class="built_in">id</span>) <span class="comment"># å±•å¼€è¡¨æ ¼ç»„ä»¶çš„ä¸Šä¸‹æ–‡ï¼Œä¸‹é¢åˆ›å»ºçš„ç»„ä»¶è‡ªåŠ¨æˆä¸ºè¡¨æ ¼çš„å­ç»„ä»¶</span></span><br><span class="line">            <span class="comment"># æ·»åŠ è¡¨æ ¼çš„åˆ—</span></span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(columns)):</span><br><span class="line">                dpg.add_table_column(label=columns[i],width_stretch=<span class="literal">True</span>, init_width_or_weight=<span class="number">0.0</span>)</span><br><span class="line"></span><br><span class="line">            dpg.pop_container_stack() <span class="comment"># å…³é—­è¡¨æ ¼çš„ä¸Šä¸‹æ–‡</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">clearData</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="comment"># æ¸…é™¤åˆ—è¡¨</span></span><br><span class="line">        <span class="keyword">for</span> item <span class="keyword">in</span> dpg.get_item_children(<span class="variable language_">self</span>.<span class="built_in">id</span>,<span class="number">1</span>):</span><br><span class="line">            dpg.delete_item(item)</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">updateData</span>(<span class="params">self,items</span>): <span class="comment"># ä¸Šä¼ æ•°æ®åˆ°è¡¨æ ¼</span></span><br><span class="line"></span><br><span class="line">        dpg.push_container_stack(<span class="variable language_">self</span>.<span class="built_in">id</span>) <span class="comment"># æ‰“å¼€è¡¨æ ¼çš„ä¸Šä¸‹æ–‡</span></span><br><span class="line">        row = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> item <span class="keyword">in</span> items:</span><br><span class="line">            row+=<span class="number">1</span></span><br><span class="line">            <span class="keyword">with</span> dpg.table_row():</span><br><span class="line">                dpg.add_text(<span class="built_in">str</span>(row)) <span class="comment"># è¾“å…¥è¡Œå·åˆ°è¡Œå·åˆ—</span></span><br><span class="line">                <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(item)):</span><br><span class="line">                    <span class="keyword">if</span>(j == <span class="number">0</span>): <span class="comment"># æ—¶é—´è¦è½¬æ¢æˆæ—¶é—´æˆ³</span></span><br><span class="line">                        date = mystampToNumStr(item[<span class="number">0</span>])</span><br><span class="line">                        dpg.add_text(date)</span><br><span class="line">                    <span class="keyword">elif</span>(j==<span class="number">10</span>):</span><br><span class="line">                        <span class="keyword">break</span></span><br><span class="line">                    <span class="keyword">else</span>:</span><br><span class="line">                        dpg.add_text(item[j])</span><br><span class="line"></span><br><span class="line">        dpg.pop_container_stack()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="å°è£…KPlotç±»"><a href="#å°è£…KPlotç±»" class="headerlink" title="å°è£…KPlotç±»"></a>å°è£…KPlotç±»</h3><p>KPlotå¯¹å¤–åªè´Ÿè´£<code>æ¥å—æ•°æ®</code>å’Œ<code>ç»˜åˆ¶ç»Ÿè®¡å›¾</code>ï¼Œè€Œå†…éƒ¨çš„å·¥ä½œæœ‰ï¼š</p>
<ul>
<li>è§£ææ•°æ®</li>
<li>åˆ›å»ºå›¾æ ‡</li>
<li>ç»˜åˆ¶å›¾æ ‡</li>
<li>æä¾›é¼ æ ‡æ‚¬åœæç¤º</li>
</ul>
<blockquote>
<p>DVWrapper.py</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">KPlot</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">with</span> dpg.stage():</span><br><span class="line">            <span class="comment"># åˆ›å»ºä¸€ä¸ªplotç»„ä»¶</span></span><br><span class="line">            <span class="keyword">with</span> dpg.plot(label=<span class="string">&quot;è´µå·èŒ…å°è‚¡ç¥¨æ—¥Kå›¾&quot;</span>,tag=<span class="string">&#x27;kplot&#x27;</span>,height=-<span class="number">1</span>,width=-<span class="number">1</span>,show=<span class="literal">False</span>) <span class="keyword">as</span> <span class="variable language_">self</span>.<span class="built_in">id</span>:</span><br><span class="line">                dpg.add_plot_legend()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">draw</span>(<span class="params">self,fetch_data</span>):</span><br><span class="line">        xData=[]</span><br><span class="line">        <span class="comment"># è¿™é‡Œä½¿ç”¨åŸç”Ÿå­—å…¸+åˆ—è¡¨è§£æè·å–åˆ°çš„æ•°æ®</span></span><br><span class="line">        yDatas=&#123;<span class="string">&quot;volume&quot;</span>:[],<span class="string">&quot;open&quot;</span>:[],<span class="string">&quot;high&quot;</span>:[],<span class="string">&quot;low&quot;</span>:[],</span><br><span class="line">                <span class="string">&quot;close&quot;</span>:[],<span class="string">&quot;chg&quot;</span>:[],<span class="string">&quot;percent&quot;</span>:[],</span><br><span class="line">                <span class="string">&quot;turnoverrate&quot;</span>:[],<span class="string">&quot;amount&quot;</span>:[]&#125;</span><br><span class="line">        <span class="keyword">for</span> line <span class="keyword">in</span> fetch_data:</span><br><span class="line">            line = <span class="built_in">list</span>(line) <span class="comment">#å°†å…ƒç»„è½¬æˆåˆ—è¡¨ï¼Œè¿™æ ·æ‰èƒ½æ‰§è¡Œpopæ“ä½œ</span></span><br><span class="line"></span><br><span class="line">            xData.append(line.pop(<span class="number">0</span>)/<span class="number">1000</span>)</span><br><span class="line">            yDatas[<span class="string">&quot;volume&quot;</span>].append(line.pop(<span class="number">0</span>))</span><br><span class="line">            yDatas[<span class="string">&quot;open&quot;</span>].append(line.pop(<span class="number">0</span>))</span><br><span class="line">            yDatas[<span class="string">&quot;high&quot;</span>].append(line.pop(<span class="number">0</span>))</span><br><span class="line">            yDatas[<span class="string">&quot;low&quot;</span>].append(line.pop(<span class="number">0</span>))</span><br><span class="line">            yDatas[<span class="string">&#x27;close&#x27;</span>].append(line.pop(<span class="number">0</span>))</span><br><span class="line">            yDatas[<span class="string">&#x27;chg&#x27;</span>].append(line.pop(<span class="number">0</span>))</span><br><span class="line">            yDatas[<span class="string">&#x27;percent&#x27;</span>].append(line.pop(<span class="number">0</span>))</span><br><span class="line">            yDatas[<span class="string">&#x27;turnoverrate&#x27;</span>].append(line.pop(<span class="number">0</span>))</span><br><span class="line">            yDatas[<span class="string">&#x27;amount&#x27;</span>].append(line.pop(<span class="number">0</span>))</span><br><span class="line"></span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">custom_tooltip_handler</span>(<span class="params">sender,app_data</span>): <span class="comment">#å£°æ˜ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œç”¨äºåœ¨é¼ æ ‡ä¸Šæ‚¬åœæ˜¾ç¤ºæ¯å¤©çš„è‚¡ç¥¨å‚æ•°</span></span><br><span class="line">            x_data,y_data=dpg.get_plot_mouse_pos()</span><br><span class="line">            date = mystampToNumStr(x_data*<span class="number">1000</span>)  <span class="comment"># å°†æ¨ªåæ ‡æ—¶é—´æˆ³è½¬æ¢æˆå…·ä½“æ—¥æœŸ</span></span><br><span class="line">            index = <span class="number">0</span></span><br><span class="line">            <span class="comment"># é€šè¿‡æ—¥æœŸåå‘å¯»æ‰¾ä¸‹æ ‡ï¼Œç„¶åå†é€šè¿‡ä¸‹æ ‡æ‰¾åˆ°å½“å¤©è‚¡ç¥¨çš„æ•°æ®</span></span><br><span class="line">            <span class="keyword">while</span>( index &lt; <span class="built_in">len</span>(xData) <span class="keyword">and</span> date != mystampToNumStr(xData[index]*<span class="number">1000</span>) ):</span><br><span class="line">                index+=<span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span>(index &lt; <span class="built_in">len</span>(xData)):</span><br><span class="line">                <span class="comment"># é€šè¿‡setValueè®¾ç½®æ‚¬åœæ˜¾ç¤ºçš„ä¿¡æ¯</span></span><br><span class="line">                dpg.set_value(<span class="string">&quot;volume tip&quot;</span>,<span class="string">f&quot;æ—¶é—´:<span class="subst">&#123;date&#125;</span> \n &quot;</span></span><br><span class="line">                                           <span class="string">f&quot;æˆäº¤é‡:<span class="subst">&#123;yDatas[<span class="string">&#x27;volume&#x27;</span>][index]&#125;</span>\n&quot;</span></span><br><span class="line">                                           <span class="string">f&quot;å¼€ç›˜ä»·:<span class="subst">&#123;yDatas[<span class="string">&#x27;open&#x27;</span>][index]&#125;</span>\n&quot;</span></span><br><span class="line">                                           <span class="string">f&quot;æœ€é«˜ä»·:<span class="subst">&#123;yDatas[<span class="string">&#x27;high&#x27;</span>][index]&#125;</span>\n&quot;</span></span><br><span class="line">                                           <span class="string">f&quot;æœ€ä½ä»·:<span class="subst">&#123;yDatas[<span class="string">&#x27;low&#x27;</span>][index]&#125;</span>\n&quot;</span></span><br><span class="line">                                           <span class="string">f&quot;æ”¶ç›˜ä»·:<span class="subst">&#123;yDatas[<span class="string">&#x27;close&#x27;</span>][index]&#125;</span>\n&quot;</span></span><br><span class="line">                                           <span class="string">f&quot;æ¶¨è·Œé¢:<span class="subst">&#123;yDatas[<span class="string">&#x27;chg&#x27;</span>][index]&#125;</span>\n&quot;</span></span><br><span class="line">                                           <span class="string">f&quot;æ¶¨è·Œå¹…<span class="subst">&#123;yDatas[<span class="string">&#x27;percent&#x27;</span>][index]&#125;</span>\n&quot;</span></span><br><span class="line">                                           <span class="string">f&quot;æ¢æ‰‹ç‡:<span class="subst">&#123;yDatas[<span class="string">&#x27;turnoverrate&#x27;</span>][index]&#125;</span>\n&quot;</span></span><br><span class="line">                                           <span class="string">f&quot;æˆäº¤é¢:<span class="subst">&#123;yDatas[<span class="string">&#x27;amount&#x27;</span>][index]&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">with</span> dpg.handler_registry(tag=<span class="string">&quot;volume hander&quot;</span>):</span><br><span class="line">            <span class="comment"># å°†é¼ æ ‡ç§»åŠ¨äº‹ä»¶çš„å›è°ƒå‡½æ•°ç»‘å®šæˆä¸Šé¢çš„è‡ªå®šä¹‰å‡½æ•°</span></span><br><span class="line">            dpg.add_mouse_move_handler(callback=custom_tooltip_handler)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># å‡†å¤‡å¼€å§‹ç»˜åˆ¶æ›²çº¿</span></span><br><span class="line">        dpg.push_container_stack(<span class="variable language_">self</span>.<span class="built_in">id</span>)</span><br><span class="line">        xaxis = dpg.add_plot_axis(dpg.mvXAxis,label=<span class="string">&quot;æ—¥æœŸ&quot;</span>,time=<span class="literal">True</span>) <span class="comment"># åˆ›å»ºæ¨ªåæ ‡,å¹¶æ ‡è®°ä¸ºä»¥æ—¶é—´ä¸ºæ¨ªåæ ‡</span></span><br><span class="line">        dpg.add_plot_axis(dpg.mvYAxis,label=<span class="string">&#x27;å¼€ç›˜ä»·&#x27;</span>,tag=<span class="string">&quot;open&quot;</span>) <span class="comment"># åˆ›å»ºçºµåæ ‡1</span></span><br><span class="line">        dpg.add_plot_axis(dpg.mvYAxis,label=<span class="string">&#x27;æ¢æ‰‹ç‡&#x27;</span>,tag=<span class="string">&quot;turnoverrate&quot;</span>) <span class="comment"># åˆ›å»ºçºµåæ ‡2</span></span><br><span class="line">        dpg.add_plot_axis(dpg.mvYAxis,label=<span class="string">&#x27;äº¤æ˜“é¢&#x27;</span>,tag=<span class="string">&quot;amount&quot;</span>) <span class="comment"># åˆ›å»ºçºµåæ ‡3</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        dpg.add_line_series(xData,yDatas[<span class="string">&quot;volume&quot;</span>],parent=<span class="string">&quot;amount&quot;</span>,label=<span class="string">&quot;æˆäº¤é‡&quot;</span>) <span class="comment"># ç»˜åˆ¶æŠ˜çº¿å›¾</span></span><br><span class="line">        <span class="comment"># ç»˜åˆ¶Kå›¾</span></span><br><span class="line">        s1id = dpg.add_candle_series(xData,opens=yDatas[<span class="string">&#x27;open&#x27;</span>],closes=yDatas[<span class="string">&#x27;close&#x27;</span>],lows=yDatas[<span class="string">&#x27;low&#x27;</span>],highs=yDatas[<span class="string">&#x27;high&#x27;</span>],parent=<span class="string">&#x27;open&#x27;</span>,label=<span class="string">&#x27;Kå›¾&#x27;</span>,time_unit=dpg.mvTimeUnit_Day)</span><br><span class="line">        dpg.add_line_series(xData,yDatas[<span class="string">&quot;open&quot;</span>],parent=<span class="string">&#x27;open&#x27;</span>,label=<span class="string">&quot;å¼€ç›˜ä»·&quot;</span>) <span class="comment"># ç»˜åˆ¶æŠ˜çº¿å›¾ï¼Œä¸‹åŒ</span></span><br><span class="line">        dpg.add_line_series(xData,yDatas[<span class="string">&quot;high&quot;</span>],parent=<span class="string">&#x27;open&#x27;</span>,label=<span class="string">&quot;æœ€é«˜ä»·&quot;</span>)</span><br><span class="line">        dpg.add_line_series(xData,yDatas[<span class="string">&quot;low&quot;</span>],parent=<span class="string">&#x27;open&#x27;</span>,label=<span class="string">&#x27;æœ€ä½ä»·&#x27;</span>)</span><br><span class="line">        dpg.add_line_series(xData,yDatas[<span class="string">&quot;close&quot;</span>],parent=<span class="string">&#x27;open&#x27;</span>,label=<span class="string">&#x27;æ”¶ç›˜ä»·&#x27;</span>)</span><br><span class="line">        dpg.add_line_series(xData,yDatas[<span class="string">&quot;chg&quot;</span>],parent=<span class="string">&#x27;turnoverrate&#x27;</span>,label=<span class="string">&#x27;æ¶¨è·Œé¢&#x27;</span>)</span><br><span class="line">        dpg.add_line_series(xData,yDatas[<span class="string">&quot;percent&quot;</span>],parent=<span class="string">&#x27;turnoverrate&#x27;</span>,label=<span class="string">&#x27;æ¶¨è·Œå¹…&#x27;</span>)</span><br><span class="line">        dpg.add_line_series(xData,yDatas[<span class="string">&quot;turnoverrate&quot;</span>],parent=<span class="string">&#x27;turnoverrate&#x27;</span>,label=<span class="string">&#x27;æ¢æ‰‹ç‡&#x27;</span>)</span><br><span class="line">        dpg.add_line_series(xData,yDatas[<span class="string">&quot;amount&quot;</span>],parent=<span class="string">&#x27;amount&#x27;</span>,label=<span class="string">&#x27;æˆäº¤é¢&#x27;</span>)</span><br><span class="line"></span><br><span class="line">        dpg.fit_axis_data(xaxis) <span class="comment"># ä½¿æ¨ªåæ ‡è‡ªé€‚åº”ï¼Œæœ€ç»ˆæ˜¾ç¤ºä¸ºå…·ä½“æ—¥æœŸ</span></span><br><span class="line">        <span class="keyword">with</span> dpg.tooltip(s1id,label=<span class="string">&#x27;tool tip&#x27;</span>,tag=<span class="string">&quot;tool tip&quot;</span>): <span class="comment"># åˆ›å»ºé¼ æ ‡æ‚¬åœæ˜¾ç¤ºçš„ç»„ä»¶</span></span><br><span class="line">            dpg.add_text(<span class="string">&quot;Hover the plot&quot;</span>,tag=<span class="string">&quot;volume tip&quot;</span>)</span><br><span class="line"></span><br><span class="line">        dpg.pop_container_stack()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="å°è£…MenuBarç±»"><a href="#å°è£…MenuBarç±»" class="headerlink" title="å°è£…MenuBarç±»"></a>å°è£…MenuBarç±»</h3><p><code>dpg</code>çš„<code>menu_bar</code>ç»„ä»¶å°±åªæ˜¯å•çº¯çš„èœå•æ ï¼Œå†…éƒ¨æ˜¯ç©ºçš„ï¼Œæ‰€ä»¥å¾—å…ˆå°è£…<code>MenuItem</code>ç±»</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">MenuItem</span>():</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,menubar,label,tag,target</span>): <span class="comment"># èœå•é€‰é¡¹ä¸å¤šä¸ªç»„ä»¶æœ‰å…³</span></span><br><span class="line">        <span class="variable language_">self</span>.parent = menubar.<span class="built_in">id</span> <span class="comment"># å‚¨å­˜parentçš„id</span></span><br><span class="line">        <span class="variable language_">self</span>.target = target <span class="comment"># å‚¨å­˜ç›®æ ‡ç©ºé—´çš„id</span></span><br><span class="line">        dpg.push_container_stack(<span class="variable language_">self</span>.parent)  <span class="comment"># å°†è‡ªå·±æ·»åŠ åˆ°parentä¸­</span></span><br><span class="line">        <span class="variable language_">self</span>.<span class="built_in">id</span> = dpg.add_menu_item(label=label,tag=tag,user_data=[menubar,<span class="variable language_">self</span>])</span><br><span class="line">        dpg.pop_container_stack()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">HideCallback</span>(<span class="params">self</span>):</span><br><span class="line">        current_visible = dpg.is_item_visible(<span class="variable language_">self</span>.target)  <span class="comment"># è·å–å½“å‰å¯è§æ€§</span></span><br><span class="line">        <span class="keyword">if</span> current_visible:</span><br><span class="line">            dpg.hide_item(<span class="variable language_">self</span>.target) <span class="comment"># è‹¥å¯è§ï¼Œåˆ™éšè—</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">setCallback</span>(<span class="params">self,callback</span>): <span class="comment"># è®¾ç½®å½“èœå•é€‰é¡¹è¢«ç‚¹å‡»æ—¶è°ƒç”¨çš„å›è°ƒå‡½æ•°</span></span><br><span class="line">        dpg.set_item_callback(<span class="variable language_">self</span>.<span class="built_in">id</span>,callback=callback)</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MenuBar</span>():</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,tag=<span class="string">&#x27;main menu&#x27;</span></span>):</span><br><span class="line">        <span class="variable language_">self</span>.children = [] <span class="comment"># åˆ—è¡¨ç”¨äºç®¡ç†æ‰€æœ‰å­ç»„ä»¶ï¼ˆæƒ¨æ·¡é€‰é¡¹ï¼‰</span></span><br><span class="line">        <span class="keyword">with</span> dpg.stage():</span><br><span class="line">            <span class="variable language_">self</span>.<span class="built_in">id</span> = dpg.add_menu_bar(tag=tag)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">add_item</span>(<span class="params">self,label,tag,target,font</span>): <span class="comment"># è®¾è®¡æ€æƒ³ä¸Šï¼Œèœå•é€‰é¡¹å¿…é¡»èƒ½è¿‡ç®¡ç†å®ƒå¯¹åº”çš„ç›®æ ‡ç»„ä»¶ï¼Œæ‰€ä»¥éœ€è¦ä¸€ä¸ªtargetæˆå‘˜å˜é‡å‚¨å­˜ç›®æ ‡id</span></span><br><span class="line">        <span class="variable language_">self</span>.children.append(MenuItem(<span class="variable language_">self</span>,label=label,tag=tag,target=target))</span><br><span class="line">        child_id = <span class="variable language_">self</span>.children[-<span class="number">1</span>].<span class="built_in">id</span></span><br><span class="line">        dpg.bind_item_font(child_id,font) <span class="comment"># ç»‘å®šèœå•é€‰é¡¹çš„å­—ä½“(ç”±å¤–éƒ¨æä¾›)</span></span><br><span class="line">        <span class="variable language_">self</span>.children[-<span class="number">1</span>].HideCallback() <span class="comment"># æ–°çš„å­©å­é»˜è®¤è°ƒç”¨ä¸€ä¸‹ä½¿ç›®æ ‡éšè—çš„å›è°ƒå‡½æ•°</span></span><br><span class="line">        <span class="keyword">return</span> child_id <span class="comment"># è¿”å›æ–°æ’å…¥å­©å­çš„id,å¤–è¾¹å¤–ç•Œç»‘å®šå›è°ƒå‡½æ•°</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">hide_children</span>(<span class="params">self</span>):<span class="comment"># æä¾›ä½¿æ‰€æœ‰è¢«æ§ç»„ä»¶éšè—çš„æ¥å£(ä¸æ˜¯è®©èœå•é€‰é¡¹éšè—)</span></span><br><span class="line">        <span class="keyword">for</span> child <span class="keyword">in</span> <span class="variable language_">self</span>.children:</span><br><span class="line">            child.HideCallback() <span class="comment"># è§„å®šMenuItemç±»å¿…é¡»æœ‰ä¸€ä¸ªHideCallbackå›è°ƒå‡½æ•°</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="å°è£…æ°´å¹³æŒ‰é’®ç»„"><a href="#å°è£…æ°´å¹³æŒ‰é’®ç»„" class="headerlink" title="å°è£…æ°´å¹³æŒ‰é’®ç»„"></a>å°è£…æ°´å¹³æŒ‰é’®ç»„</h3><p>è™½ç„¶ç›®å‰åªæœ‰ä¸€ä¸ªæŒ‰é’®ï¼Œä½†æ˜¯ä¸ºäº†æ–¹ä¾¿ä»¥ååœ¨åŒä¸€è¡Œæ”¾æ›´å¤šçš„æŒ‰é’®ï¼Œæˆ‘ä»¬é€‰æ‹©å†é¢å¤–å°è£…ä¸€ä¸ª<code>Group</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">HorGroup</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,width=<span class="number">40</span></span>):<span class="comment"># æä¾›å¯è®¾ç½®çš„å®½åº¦</span></span><br><span class="line">        <span class="keyword">with</span> dpg.stage():</span><br><span class="line">            <span class="comment"># horizontal=True,è®¾ç½®ç»„å†…çš„ç»„ä»¶æ°´å¹³æ”¾ç½®</span></span><br><span class="line">            <span class="variable language_">self</span>.<span class="built_in">id</span> = dpg.add_group(horizontal=<span class="literal">True</span>,width=width)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">add_child</span>(<span class="params">self,child</span>): <span class="comment">#  æä¾›å¢åŠ å­ç»„ä»¶çš„æ¥å£</span></span><br><span class="line">        dpg.move_item(child.<span class="built_in">id</span>,parent=<span class="variable language_">self</span>.<span class="built_in">id</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">add_spacer</span>(<span class="params">self</span>):<span class="comment">#  æä¾›å¢åŠ ç©ºä½çš„æ¥å£</span></span><br><span class="line">        dpg.push_container_stack(<span class="variable language_">self</span>.<span class="built_in">id</span>)</span><br><span class="line">        dpg.add_spacer()</span><br><span class="line">        dpg.pop_container_stack()</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Button</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,label,tag</span>):</span><br><span class="line">        <span class="keyword">with</span> dpg.stage():</span><br><span class="line">            <span class="variable language_">self</span>.<span class="built_in">id</span>=dpg.add_button(label=label,tag=tag,width=<span class="number">150</span>,height=<span class="number">40</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">setcallback</span>(<span class="params">self,callback</span>):</span><br><span class="line">        dpg.set_item_callback(<span class="variable language_">self</span>.<span class="built_in">id</span>,callback=callback)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="ç±»å®ä¾‹åŒ–å’Œæ„å»ºå¯è§†åŒ–é¡µé¢"><a href="#ç±»å®ä¾‹åŒ–å’Œæ„å»ºå¯è§†åŒ–é¡µé¢" class="headerlink" title="ç±»å®ä¾‹åŒ–å’Œæ„å»ºå¯è§†åŒ–é¡µé¢"></a>ç±»å®ä¾‹åŒ–å’Œæ„å»ºå¯è§†åŒ–é¡µé¢</h3><p>ç‰¹åˆ«çš„ï¼Œç”±äº<code>dpg</code>é»˜è®¤ä¸æ”¯æŒä¸­æ–‡å­—ä½“ï¼Œæ‰€ä»¥è¦åœ¨é¡¹ç›®é‡Œå‡†å¤‡ä¸€ä¸ªæ”¯æŒä¸­æ–‡è‡ªå·±çš„æ–‡ä»¶ï¼Œå¹¶åœ¨ç¨‹åºä¸­ä½¿ç”¨è¯¥å­—ä½“ï¼Œæ‰èƒ½æ­£å¸¸æ˜¾ç¤ºä¸­æ–‡</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> dearpygui.dearpygui <span class="keyword">as</span> dpg</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> DVWrapper <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> DBManager <span class="keyword">as</span> dbm</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">maotai = GZMaoTai()</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getTimestamp</span>():<span class="comment"># è·å–ç§’çº§çš„å½“å‰æ—¶é—´æˆ³</span></span><br><span class="line">    t=time.time()</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">int</span>(<span class="built_in">round</span>(t*<span class="number">1000</span>))</span><br><span class="line"></span><br><span class="line">dpg.create_context()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">commonMenuCallback</span>(<span class="params">sender,app_data,user_data</span>): <span class="comment"># å£°æ˜é€šç”¨çš„èœå•é€‰é¡¹çš„å›è°ƒå‡½æ•°</span></span><br><span class="line">    user_data[<span class="number">0</span>].hide_children() <span class="comment">#è§„å®šuser_data[0]ä¸ºèœå•å¯¹è±¡,éšè—æ‰€æœ‰è¢«æ§ç»„ä»¶</span></span><br><span class="line">    dpg.show_item(user_data[<span class="number">1</span>].target) <span class="comment"># æœ€åå†åªæ˜¾ç¤ºè‡ªå·±</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">DBUpdateCallback</span>(<span class="params">sender,app_data</span>):  <span class="comment"># å£°æ˜æŒ‰ä¸‹æŒ‰é’®çš„å›è°ƒå‡½æ•°</span></span><br><span class="line">    dpg.set_item_label(sender,<span class="string">&quot;æ•°æ®æ›´æ–°ä¸­...&quot;</span>) <span class="comment">#æ›´æ”¹æŒ‰é’®æ˜¾ç¤ºå†…å®¹</span></span><br><span class="line">    dpg.disable_item(sender) <span class="comment"># è°ƒç”¨å‡½æ•°æœŸé—´ä½¿æŒ‰é’®æ— æ•ˆåŒ–</span></span><br><span class="line">    dbm.clearDB() <span class="comment"># æ¸…ç©ºæ•°æ®åº“</span></span><br><span class="line">    my_table.clearData() <span class="comment"># æƒ…å†µè¡¨æ ¼</span></span><br><span class="line">    items = maotai.get_response(getTimestamp())  <span class="comment"># è·å–æœ€æ–°æ•°æ®</span></span><br><span class="line">    dbm.sendData(items)  <span class="comment"># å‘æ•°æ®åº“å‘é€æ•°æ®</span></span><br><span class="line">    fetch_data = dbm.getLatestData()  <span class="comment"># ä»æ•°æ®åº“è·å–æ•°æ®</span></span><br><span class="line">    my_table.updateData(fetch_data)  <span class="comment"># æ›´æ–°è¡¨æ ¼</span></span><br><span class="line">    dpg.set_item_label(sender,<span class="string">&quot;æ›´æ–°æ•°æ®åº“æ•°æ®&quot;</span>)  <span class="comment"># æ”¹å›æŒ‰é’®çš„æ˜¾ç¤ºå†…å®¹</span></span><br><span class="line">    dpg.enable_item((sender)) <span class="comment"># é‡æ–°å¯ç”¨æŒ‰é’®</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">######  è®¾ç½®å­—ä½“ ###########</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> dpg.font_registry():</span><br><span class="line">    <span class="keyword">with</span> dpg.font(<span class="string">&quot;./fonts/msyh.ttc&quot;</span>,<span class="number">20</span>) <span class="keyword">as</span> default_font:</span><br><span class="line">        dpg.add_font_range_hint(dpg.mvFontRangeHint_Chinese_Simplified_Common)</span><br><span class="line">    <span class="keyword">with</span> dpg.font(<span class="string">&quot;./fonts/msyh.ttc&quot;</span>,<span class="number">25</span>) <span class="keyword">as</span> big_font:</span><br><span class="line">        dpg.add_font_range_hint(dpg.mvFontRangeHint_Chinese_Simplified_Common)</span><br><span class="line">    <span class="keyword">with</span> dpg.font(<span class="string">&quot;./fonts/msyh.ttc&quot;</span>,<span class="number">20</span>) <span class="keyword">as</span> menufont:</span><br><span class="line">        dpg.add_font_range_hint(dpg.mvFontRangeHint_Chinese_Simplified_Common)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">###### ç¨‹åºä¸»è¦å†…å®¹ ########</span></span><br><span class="line"><span class="comment"># æ„å»ºå¯è§†åŒ–ç»„ä»¶</span></span><br><span class="line">my_table = DataTable() <span class="comment"># å®ä¾‹åŒ–è¡¨æ ¼</span></span><br><span class="line"></span><br><span class="line">update_button = Button(label=<span class="string">&quot;æ›´æ–°æ•°æ®åº“æ•°æ®&quot;</span>,tag=<span class="string">&quot;update button&quot;</span>) <span class="comment"># å®ä¾‹åŒ–æŒ‰é’®</span></span><br><span class="line">update_button.setcallback(DBUpdateCallback)  <span class="comment"># è®¾ç½®å›è°ƒå‡½æ•°</span></span><br><span class="line"></span><br><span class="line">kplot = KPlot() <span class="comment"># å®ä¾‹åŒ–å›¾æ ‡</span></span><br><span class="line"></span><br><span class="line">menubar = MenuBar() <span class="comment"># å®ä¾‹åŒ–èœå•æ </span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ·»åŠ èœå•æ é€‰é¡¹</span></span><br><span class="line">table_menu = menubar.add_item(label=<span class="string">&quot;è¡¨æ ¼&quot;</span>,tag=<span class="string">&quot;table&quot;</span>,target=my_table.<span class="built_in">id</span>,font=menufont)</span><br><span class="line">kplot_menu = menubar.add_item(label=<span class="string">&quot;æ—¥Kå›¾&quot;</span>,tag=<span class="string">&quot;Kplot&quot;</span>,target=kplot.<span class="built_in">id</span>,font=menufont)</span><br><span class="line"><span class="comment"># ç»‘å®šæƒ¨æ·¡äº†é€‰é¡¹çš„å›è°ƒå‡½æ•°</span></span><br><span class="line">dpg.set_item_callback(table_menu,commonMenuCallback)</span><br><span class="line">dpg.set_item_callback(kplot_menu,commonMenuCallback)</span><br><span class="line"><span class="comment"># åˆ›å»ºçª—å£</span></span><br><span class="line">main_win = Window(label=<span class="string">&quot;main_win&quot;</span>,tag=<span class="string">&quot;main_win&quot;</span>)</span><br><span class="line"><span class="comment"># åˆ›å»ºå­çª—å£</span></span><br><span class="line">top_child_win = Child_Window(width=-<span class="number">1</span>,height=<span class="number">400</span>)</span><br><span class="line">top_child_win.add_child(my_table)</span><br><span class="line">top_child_win.add_child(kplot)</span><br><span class="line"></span><br><span class="line"><span class="comment">## æ„å»ºçˆ¶å­å…³ç³»</span></span><br><span class="line">dpg.bind_font(default_font)</span><br><span class="line">dpg.bind_item_font(update_button.<span class="built_in">id</span>,big_font)</span><br><span class="line">dpg.bind_item_font(menubar.<span class="built_in">id</span>,menufont)</span><br><span class="line">main_win.add_child(menubar)</span><br><span class="line">main_win.add_child(top_child_win)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">button_group = HorGroup(width=<span class="number">300</span>)</span><br><span class="line">button_group.add_spacer()</span><br><span class="line">inner_group = HorGroup()</span><br><span class="line">inner_group.add_child(update_button)</span><br><span class="line"><span class="comment"># inner_group.add_child(clear_button)</span></span><br><span class="line">button_group.add_child(inner_group)</span><br><span class="line">button_group.add_spacer()</span><br><span class="line">main_win.add_child(button_group)</span><br><span class="line"></span><br><span class="line">main_win.submit()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># items = maotai.get_response(getTimestamp())</span></span><br><span class="line"></span><br><span class="line">fetch_data = dbm.getLatestData()</span><br><span class="line">my_table.updateData(fetch_data)</span><br><span class="line">kplot.draw(fetch_data)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">dbm.closeDB()</span><br><span class="line">dpg.create_viewport(title=<span class="string">&#x27;Custom Title&#x27;</span>, width=<span class="number">1400</span>, height=<span class="number">600</span>)</span><br><span class="line">dpg.setup_dearpygui()</span><br><span class="line">dpg.show_viewport()</span><br><span class="line">dpg.set_primary_window(<span class="string">&quot;main_win&quot;</span>, <span class="literal">True</span>) <span class="comment"># çœŸæ­£è®¾ç½®åˆå§‹çª—å£</span></span><br><span class="line">dpg.start_dearpygui()</span><br><span class="line"></span><br><span class="line">dpg.destroy_context()</span><br></pre></td></tr></table></figure>
<h1 id="æˆå“å±•ç¤º"><a href="#æˆå“å±•ç¤º" class="headerlink" title="æˆå“å±•ç¤º"></a>æˆå“å±•ç¤º</h1><p><em>(æ–‡ä»¶è¾ƒå¤§ï¼Œè¯·è€å¿ƒç­‰å¾…åŠ è½½)</em></p>
<p><img src="https://picbed0521.oss-cn-shanghai.aliyuncs.com/blogpic/202410091543883.gif"></p>
<h1 id="å°ç»“-1"><a href="#å°ç»“-1" class="headerlink" title="å°ç»“"></a>å°ç»“</h1><p>åœ¨æœ¬æ¬¡é¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†äº’è”ç½‘çˆ¬è™«æŠ€æœ¯å’Œå¯è§†åŒ–æŠ€æœ¯å®Œæˆäº†é¡¹ç›®ç›®æ ‡ï¼Œèƒ½å¤Ÿæ–¹ä¾¿åœ°æŸ¥è¯¢è‚¡ç¥¨æ•°æ®å’Œåˆ†æè‚¡ç¥¨çš„æ—¥Kå›¾ã€‚</p>
<p><a target="_blank" rel="noopener" href="https://github.com/sis-shen/OLSIC">æˆ³æˆ‘å»githubä»“åº“ğŸ”—</a></p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">æ–‡ç« ä½œè€…: </span><span class="post-copyright-info"><a href="http://supdriver.top">å‰¯é©¾supdriver</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">æ–‡ç« é“¾æ¥: </span><span class="post-copyright-info"><a href="http://supdriver.top/2024/09/15/OLSIC/">http://supdriver.top/2024/09/15/OLSIC/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">ç‰ˆæƒå£°æ˜: </span><span class="post-copyright-info">æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜æ¥è‡ª <a href="http://supdriver.top" target="_blank">supdriverçš„åšå®¢</a>ï¼</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="https://picbed0521.oss-cn-shanghai.aliyuncs.com/blogpic/OLSIC_cover.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2024/09/03/ACVA/" title="ã€pythoné¡¹ç›®å®è·µã€‘ACVAèˆªç©ºå…¬å¸å®¢æˆ·ä»·å€¼åˆ†æ"><img class="cover" src="https://picbed0521.oss-cn-shanghai.aliyuncs.com/blogpic/ACVA_COVER.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">ä¸Šä¸€ç¯‡</div><div class="prev_info">ã€pythoné¡¹ç›®å®è·µã€‘ACVAèˆªç©ºå…¬å¸å®¢æˆ·ä»·å€¼åˆ†æ</div></div></a></div><div class="next-post pull-right"><a href="/2024/09/23/network/" title="åˆè¯†è®¡ç®—æœºç½‘ç»œ"><img class="cover" src="https://picbed0521.oss-cn-shanghai.aliyuncs.com/blogpic/202410191623428.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">ä¸‹ä¸€ç¯‡</div><div class="next_info">åˆè¯†è®¡ç®—æœºç½‘ç»œ</div></div></a></div></nav><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> è¯„è®º</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://picbed0521.oss-cn-shanghai.aliyuncs.com/blogpic/avatar.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">å‰¯é©¾supdriver</div><div class="author-info__description">åŠ¨ç‰©ç•Œ è„Šç´¢åŠ¨ç‰©é—¨ å“ºä¹³çº² çµé•¿ç›® äººç§‘ äººå± æ™ºäººç§</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">78</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">21</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">0</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/sis-shen"><i class="fab fa-github"></i><span>æˆ‘githubè¿˜è›®å¤§çš„</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/sis-shen" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>å…¬å‘Š</span></div><div class="announcement_content"><center>ä¸»åŸŸåï¼š<br><a target="_blank" rel="noopener" href="https://www.supdriver.top"><b><font color="#5ea6e5">supdriver.top</font></b></a></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>ç›®å½•</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%83%8C%E6%99%AF%E5%88%86%E6%9E%90"><span class="toc-number">1.</span> <span class="toc-text">èƒŒæ™¯åˆ†æ</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%83%8C%E6%99%AF%E6%A6%82%E8%BF%B0"><span class="toc-number">1.1.</span> <span class="toc-text">èƒŒæ™¯æ¦‚è¿°</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BD%91%E7%BB%9C%E8%82%A1%E7%A5%A8%E4%BF%A1%E6%81%AF%E7%88%AC%E8%99%AB"><span class="toc-number">1.2.</span> <span class="toc-text">ç½‘ç»œè‚¡ç¥¨ä¿¡æ¯çˆ¬è™«</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96"><span class="toc-number">1.3.</span> <span class="toc-text">æ•°æ®å¯è§†åŒ–</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B0%8F%E7%BB%93"><span class="toc-number">1.4.</span> <span class="toc-text">å°ç»“</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%9A%E5%8A%A1%E6%B5%81%E7%A8%8B%E5%9B%BE"><span class="toc-number">1.5.</span> <span class="toc-text">ä¸šåŠ¡æµç¨‹å›¾</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0%E4%B8%9A%E5%8A%A1%E5%8A%9F%E8%83%BD"><span class="toc-number">2.</span> <span class="toc-text">ä»£ç å®ç°ä¸šåŠ¡åŠŸèƒ½</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E6%A1%86%E6%9E%B6"><span class="toc-number">2.1.</span> <span class="toc-text">ä»£ç æ¡†æ¶</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BD%91%E7%BB%9C%E7%88%AC%E8%99%AB"><span class="toc-number">2.2.</span> <span class="toc-text">ç½‘ç»œçˆ¬è™«</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BD%91%E9%A1%B5%E5%88%86%E6%9E%90"><span class="toc-number">2.2.1.</span> <span class="toc-text">ç½‘é¡µåˆ†æ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%81%E8%A3%85%E7%B1%BB"><span class="toc-number">2.2.2.</span> <span class="toc-text">å°è£…ç±»</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E6%8C%81%E4%B9%85%E5%8C%96"><span class="toc-number">2.3.</span> <span class="toc-text">æ•°æ®åº“æŒä¹…åŒ–</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E5%87%86%E5%A4%87"><span class="toc-number">2.3.1.</span> <span class="toc-text">æ•°æ®åº“å‡†å¤‡</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E5%B0%81%E8%A3%85"><span class="toc-number">2.3.2.</span> <span class="toc-text">ä»£ç å°è£…</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#GUI%E5%8F%AF%E8%A7%86%E5%8C%96%E5%92%8CK%E5%9B%BE%E7%BB%98%E5%88%B6"><span class="toc-number">2.4.</span> <span class="toc-text">GUIå¯è§†åŒ–å’ŒKå›¾ç»˜åˆ¶</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A1%B5%E9%9D%A2%E8%AE%BE%E8%AE%A1"><span class="toc-number">2.4.1.</span> <span class="toc-text">é¡µé¢è®¾è®¡</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%81%E8%A3%85%E4%B8%BB%E7%AA%97%E5%8F%A3%E7%B1%BB%E5%B9%B6%E6%98%BE%E7%A4%BA"><span class="toc-number">2.4.2.</span> <span class="toc-text">å°è£…ä¸»çª—å£ç±»å¹¶æ˜¾ç¤º</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%81%E8%A3%85%E5%AD%90%E7%AA%97%E5%8F%A3%E7%B1%BB"><span class="toc-number">2.4.3.</span> <span class="toc-text">å°è£…å­çª—å£ç±»</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%81%E8%A3%85Table%E7%B1%BB"><span class="toc-number">2.4.4.</span> <span class="toc-text">å°è£…Tableç±»</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%81%E8%A3%85KPlot%E7%B1%BB"><span class="toc-number">2.4.5.</span> <span class="toc-text">å°è£…KPlotç±»</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%81%E8%A3%85MenuBar%E7%B1%BB"><span class="toc-number">2.4.6.</span> <span class="toc-text">å°è£…MenuBarç±»</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%81%E8%A3%85%E6%B0%B4%E5%B9%B3%E6%8C%89%E9%92%AE%E7%BB%84"><span class="toc-number">2.4.7.</span> <span class="toc-text">å°è£…æ°´å¹³æŒ‰é’®ç»„</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B1%BB%E5%AE%9E%E4%BE%8B%E5%8C%96%E5%92%8C%E6%9E%84%E5%BB%BA%E5%8F%AF%E8%A7%86%E5%8C%96%E9%A1%B5%E9%9D%A2"><span class="toc-number">2.4.8.</span> <span class="toc-text">ç±»å®ä¾‹åŒ–å’Œæ„å»ºå¯è§†åŒ–é¡µé¢</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%88%90%E5%93%81%E5%B1%95%E7%A4%BA"><span class="toc-number">3.</span> <span class="toc-text">æˆå“å±•ç¤º</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%B0%8F%E7%BB%93-1"><span class="toc-number">4.</span> <span class="toc-text">å°ç»“</span></a></li></ol></div></div></div></div></main><footer id="footer" style="background: rgba(0,0,0,0)"><div id="footer-wrap"><div class="copyright">&copy;2023 - 2025 By å‰¯é©¾supdriver</div><div class="framework-info"><span>æ¡†æ¶ </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>ä¸»é¢˜ </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">I wish you to become your own sun, no need to rely on who's light.<p><a target="_blank" href="https://hexo.io/"><img src="https://img.shields.io/badge/Frame-Hexo-blue?style=flat&logo=hexo" title="åšå®¢æ¡†æ¶ä¸ºHexo"></a>&nbsp;<a target="_blank" href="https://butterfly.js.org/"><img src="https://img.shields.io/badge/Theme-Butterfly-6513df?style=flat&logo=bitdefender" title="ä¸»é¢˜é‡‡ç”¨butterfly"></a>&nbsp;<a target="_blank" href="https://www.jsdelivr.com/"><img src="https://img.shields.io/badge/CDN-jsDelivr-orange?style=flat&logo=jsDelivr" title="æœ¬ç«™ä½¿ç”¨JsDelivrä¸ºé™æ€èµ„æºæä¾›CDNåŠ é€Ÿ"></a> &nbsp;<a target="_blank" href="https://vercel.com/ "><img src="https://img.shields.io/badge/Hosted-Vervel-brightgreen?style=flat&logo=Vercel" title="æœ¬ç«™é‡‡ç”¨åŒçº¿éƒ¨ç½²ï¼Œé»˜è®¤çº¿è·¯æ‰˜ç®¡äºVercel"></a>&nbsp;<a target="_blank" href="https://vercel.com/ "><img src="https://img.shields.io/badge/Hosted-Coding-0cedbe?style=flat&logo=Codio" title="æœ¬ç«™é‡‡ç”¨åŒçº¿éƒ¨ç½²ï¼Œè”é€šçº¿è·¯æ‰˜ç®¡äºCoding"></a>&nbsp;<a target="_blank" href="https://github.com/"><img src="https://img.shields.io/badge/Source-Github-d021d6?style=flat&logo=GitHub" title="æœ¬ç«™é¡¹ç›®ç”±Gtihubæ‰˜ç®¡"></a>&nbsp;<a target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img src="https://img.shields.io/badge/Copyright-BY--NC--SA%204.0-d42328?style=flat&logo=Claris" title="æœ¬ç«™é‡‡ç”¨çŸ¥è¯†å…±äº«ç½²å-éå•†ä¸šæ€§ä½¿ç”¨-ç›¸åŒæ–¹å¼å…±äº«4.0å›½é™…è®¸å¯åè®®è¿›è¡Œè®¸å¯"></a></p></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="é˜…è¯»æ¨¡å¼"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="æµ…è‰²å’Œæ·±è‰²æ¨¡å¼è½¬æ¢"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="å•æ å’ŒåŒæ åˆ‡æ¢"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="è®¾ç½®"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="ç›®å½•"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="ç›´è¾¾è¯„è®º"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="å›åˆ°é¡¶éƒ¨"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"><script>(()=>{
  const init = () => {
    twikoo.init(Object.assign({
      el: '#twikoo-wrap',
      envId: 'https://hbcom.supdriver.top/',
      region: '',
      onCommentLoaded: function () {
        btf.loadLightbox(document.querySelectorAll('#twikoo .tk-content img:not(.tk-owo-emotion)'))
      }
    }, null))
  }

  const getCount = () => {
    const countELement = document.getElementById('twikoo-count')
    if(!countELement) return
    twikoo.getCommentsCount({
      envId: 'https://hbcom.supdriver.top/',
      region: '',
      urls: [window.location.pathname],
      includeReply: false
    }).then(function (res) {
      countELement.textContent = res[0].count
    }).catch(function (err) {
      console.error(err);
    });
  }

  const runFn = () => {
    init()
    GLOBAL_CONFIG_SITE.isPost && getCount()
  }

  const loadTwikoo = () => {
    if (typeof twikoo === 'object') {
      setTimeout(runFn,0)
      return
    } 
    getScript('https://cdn.jsdelivr.net/npm/twikoo/dist/twikoo.all.min.js').then(runFn)
  }

  if ('Twikoo' === 'Twikoo' || !true) {
    if (true) btf.loadComment(document.getElementById('twikoo-wrap'), loadTwikoo)
    else loadTwikoo()
  } else {
    window.loadOtherComment = () => {
      loadTwikoo()
    }
  }
})()</script></div><script async src="/js/title.js"></script><canvas id="universe"></canvas><script defer src="/js/universe.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">æœç´¢</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  æ•°æ®åº“åŠ è½½ä¸­</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="æœç´¢æ–‡ç« " type="text"/></div></div><hr/><div class="no-result" id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div><!-- hexo injector body_end start --><script data-pjax>
    function butterfly_categories_card_injector_config(){
      var parent_div_git = document.getElementById('recent-posts');
      var item_html = '<style>li.categoryBar-list-item{width:32.3%;}.categoryBar-list{max-height: 380px;overflow:auto;}.categoryBar-list::-webkit-scrollbar{width:0!important}@media screen and (max-width: 650px){.categoryBar-list{max-height: 320px;}}</style><div class="recent-post-item" style="height:auto;width:100%;padding:0px;"><div id="categoryBar"><ul class="categoryBar-list"></ul></div></div>';
      console.log('å·²æŒ‚è½½butterfly_categories_card')
      parent_div_git.insertAdjacentHTML("afterbegin",item_html)
      }
    if( document.getElementById('recent-posts') && (location.pathname ==='/'|| '/' ==='all')){
    butterfly_categories_card_injector_config()
    }
  </script><!-- hexo injector body_end end --></body></html>